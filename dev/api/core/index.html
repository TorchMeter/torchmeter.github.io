<!-- 
TorchMeter, AGPL-3.0 license
Author: Ahzyuan
Repo: https://github.com/TorchMeter/torchmeter 
-->


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Torchmeter â²ï¸:  Your all-in-one tool for Pytorch model analysis, measuring Params, FLOPs/MACs(aka. MACC or MADD), Memory cost, Inference time and Throughput ðŸš€">
      
      
        <meta name="author" content="Ahzyuan">
      
      
        <link rel="canonical" href="https://docs.torchmeter.top/latest/api/core/">
      
      
        <link rel="prev" href="../../cheatsheet/">
      
      
        <link rel="next" href="../../contribute/welcome_contributors/">
      
      
      <link rel="icon" href="../../assets/logo/logo_black.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Core - TorchMeter Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#torchmeter.core.Meter" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're viewing an old/unstable version.
  <a href="../../.."> 
    <strong>Click here to go to the latest stable one.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TorchMeter Docs" class="md-header__button md-logo" aria-label="TorchMeter Docs" data-md-component="logo">
      
  <img src="../../assets/banner/banner_noeffect.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TorchMeter Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Core
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/TorchMeter/torchmeter" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    TorchMeter/torchmeter
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Intros

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../demo/" class="md-tabs__link">
        
  
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../cheatsheet/" class="md-tabs__link">
        
  
  
    
  
  Cheatsheet

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contribute/welcome_contributors/" class="md-tabs__link">
          
  
  
    
  
  Contribute

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../others/architecture/" class="md-tabs__link">
          
  
  
    
  
  Others

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TorchMeter Docs" class="md-nav__button md-logo" aria-label="TorchMeter Docs" data-md-component="logo">
      
  <img src="../../assets/banner/banner_noeffect.png" alt="logo">

    </a>
    TorchMeter Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/TorchMeter/torchmeter" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    TorchMeter/torchmeter
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intros
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cheatsheet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#torchmeter.core.Meter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Meter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â Meter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.cal" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.device" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.ipt" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ipt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.ittp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ittp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.mem" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;mem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.model_info" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.param" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;param
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.structure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.subnodes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;subnodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.table_column_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;table_column_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.table_display_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;table_display_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.tree_fold_repeat" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tree_fold_repeat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.tree_levels_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tree_levels_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.tree_repeat_block_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tree_repeat_block_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__delattr__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__delattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__device_detect" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__device_detect
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__get_clsattr_with_settable_flag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__get_clsattr_with_settable_flag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__is_ipt_changed" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__is_ipt_changed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__setattr__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__setattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.overview" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.profile" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.rebase" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rebase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.stat_info" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stat_info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.table_cols" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;table_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.to" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../contribute/welcome_contributors/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Contribute
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../others/architecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Others
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#torchmeter.core.Meter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Meter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Â Meter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.cal" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;cal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.device" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.ipt" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ipt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.ittp" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;ittp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.mem" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;mem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.model_info" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;model_info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.param" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;param
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.structure" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.subnodes" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;subnodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.table_column_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;table_column_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.table_display_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;table_display_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.tree_fold_repeat" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tree_fold_repeat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.tree_levels_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tree_levels_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.tree_repeat_block_args" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;tree_repeat_block_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__delattr__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__delattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__device_detect" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__device_detect
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__get_clsattr_with_settable_flag" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__get_clsattr_with_settable_flag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__getattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__is_ipt_changed" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__is_ipt_changed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.__setattr__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__setattr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.overview" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.profile" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;profile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.rebase" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rebase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.stat_info" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stat_info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.table_cols" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;table_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torchmeter.core.Meter.to" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

<!-- hide h1 for index.md -->





                  


  
  
    
      
    
    <a href="https://github.com/TorchMeter/torchmeter/tree/master/docs/src/en/api/core.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Core</h1>

<div class="doc doc-object doc-class">



<h2 id="torchmeter.core.Meter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">torchmeter.core.Meter</span>


<a href="#torchmeter.core.Meter" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Meter</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">device</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>A comprehensive instrumentation tool for PyTorch model performance analysis and visualization.</p>
<p>The <code>Meter</code> class provides end-to-end measurement capabilities for neural networks, including
<strong>parameter statistics</strong>, <strong>computational cost analysis</strong>, <strong>memory usage tracking</strong>, <strong>inference time</strong> and
<strong>throughput analysis</strong>. It serves as a wrapper around <code>PyTorch</code> modules while maintaining full compatibility
with native model operations.</p>
<p><strong>Key Features</strong>:</p>
<ol>
<li>
<p><strong>Zero-Intrusion Proxy</strong></p>
<ul>
<li>acts as drop-in decorator without any changes of the underlying model</li>
<li>Seamlessly integrates with PyTorch modules while preserving full compatibility (attributes and methods)</li>
</ul>
</li>
<li>
<p><strong>Full-Stack Model Analytics</strong>: Holistic performance analytics across 5 dimensions:</p>
<ul>
<li>parameter distribution</li>
<li>calculation cost: FLOPs/MACs</li>
<li>memory access assessment</li>
<li>inference latency</li>
<li>throughput benchmarking</li>
</ul>
</li>
<li>
<p><strong>Rich visualization</strong></p>
<ul>
<li>Programmable tabular reports with real-time rendering</li>
<li>Hierarchical operation tree with smart folding of repeated blocks for model structure insights</li>
</ul>
</li>
<li>
<p><strong>Fine-Grained Customization</strong></p>
<ul>
<li>Real-time hot-reload rendering: Dynamic adjustment of rendering configuration for operation trees,
                                report tables and their nested components</li>
<li>Progressive update: Namespace assignment + dictionary batch update</li>
</ul>
</li>
<li>
<p><strong>Config-Driven Runtime Management</strong></p>
<ul>
<li>Centralized control: Singleton-managed global configuration for dynamic behavior adjustment</li>
<li>Portable presets: Export/import YAML profiles for runtime behaviors, eliminating repetitive setup</li>
</ul>
</li>
<li>
<p><strong>Portability and Practicality</strong></p>
<ul>
<li>Decoupled pipeline: Separation of data collection and visualization</li>
<li>Automatic device synchronization: Maintains production-ready status by keeping model and data co-located</li>
<li>Dual-mode reporting with export flexibility:<ul>
<li>Measurement units mode vs. raw data mode</li>
<li>Multi-format export (<code>CSV</code>/<code>Excel</code>) for analysis integration</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>Core Functionality</strong>:</p>
<ol>
<li>
<p>Parameter Analysis</p>
<ul>
<li>Total/trainable parameter quantification</li>
<li>Layer-wise parameter distribution analysis</li>
<li>Gradient state tracking (requires_grad flags)</li>
</ul>
</li>
<li>
<p>Computational Profiling</p>
<ul>
<li>FLOPs/MACs precision calculation</li>
<li>Operation-wise calculation distribution analysis</li>
<li>Dynamic input/output detection (number, type, shape, ...)</li>
</ul>
</li>
<li>
<p>Memory Diagnostics</p>
<ul>
<li>Input/output tensor memory awareness</li>
<li>Hierarchical memory consumption analysis</li>
</ul>
</li>
<li>
<p>Performance Benchmarking</p>
<ul>
<li>Auto warm-up phase execution (eliminates cold-start bias)</li>
<li>Device-specific high-precision timing</li>
<li>Inference latency  &amp; Throughput Benchmarking</li>
</ul>
</li>
<li>
<p>Visualization Engine</p>
<ul>
<li>Centralized configuration management</li>
<li>Programmable tabular report<ol>
<li>Style customization and real-time rendering</li>
<li>Dynamic table structure adjustment</li>
<li>Real-time data analysis in programmable way</li>
<li>Multi-format data export</li>
</ol>
</li>
<li>Rich-text hierarchical structure tree rendering<ol>
<li>Style customization and real-time rendering</li>
<li>Smart module folding based on structural equivalence detection</li>
</ol>
</li>
</ul>
</li>
<li>
<p>Cross-Platform Support</p>
<ul>
<li>Automatic model-data co-location</li>
<li>Seamless device transition (CPU/CUDA)</li>
</ul>
</li>
</ol>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.ipt">ipt</a></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input arguments for underlying model's <code>forward</code> method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.device">device</a></code></td>
            <td>
                  <code><span title="torch.device">device</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current computation device for model and tensor data in input .</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="torchmeter.core.Meter.model">model</span></code></td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The wrapped PyTorch model instance.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="torchmeter.core.Meter.optree">optree</span></code></td>
            <td>
                  <code><span title="OperationTree">OperationTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A backend hierarchical data structure of model operations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="torchmeter.core.Meter.tree_renderer">tree_renderer</span></code></td>
            <td>
                  <code><span title="TreeRenderer">TreeRenderer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A renderer for operation tree visualization.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="torchmeter.core.Meter.table_renderer">table_renderer</span></code></td>
            <td>
                  <code><span title="TabularRenderer">TabularRenderer</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A renderer for programmable tabular reports.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="torchmeter.core.Meter.ittp_warmup">ittp_warmup</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of warm-up(i.e., feed-forward inference) iterations before <code>ittp</code> measurement.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="torchmeter.core.Meter.ittp_benchmark_time">ittp_benchmark_time</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of benchmark iterations per operation in measuring <code>ittp</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.tree_fold_repeat">tree_fold_repeat</a></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fold repeated blocks in the rendered tree structure.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.tree_levels_args">tree_levels_args</a></code></td>
            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering configuration for various levels of rendered tree structure.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.tree_repeat_block_args">tree_repeat_block_args</a></code></td>
            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering configuration for repeated blocks of rendered tree structure.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.table_display_args">table_display_args</a></code></td>
            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Comprehensive rendering configuration for rendered tables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.table_column_args">table_column_args</a></code></td>
            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendering configuration for all of the rendered tables' columns.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.structure">structure</a></code></td>
            <td>
                  <code><span title="rich.tree.Tree">Tree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A stylized tree representation of the model's operation hierarchy.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.param">param</a></code></td>
            <td>
                  <code><span title="torchmeter.statistic.ParamsMeter">ParamsMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ParamsMeter instance containing the measured parameter-related statistics.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.cal">cal</a></code></td>
            <td>
                  <code><span title="torchmeter.statistic.CalMeter">CalMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A CalMeter instance containing the measured computational cost data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.mem">mem</a></code></td>
            <td>
                  <code><span title="torchmeter.statistic.MemMeter">MemMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A MemMeter instance containing the measured memory usage data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.ittp">ittp</a></code></td>
            <td>
                  <code><span title="torchmeter.statistic.IttpMeter">IttpMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A IttpMeter instance containing fresh inference time and throughput data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.model_info">model_info</a></code></td>
            <td>
                  <code><span title="rich.text.Text">Text</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>rich.Text</code> object containing the formatted model information.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.subnodes">subnodes</a></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of all nodes in the operation tree with their IDs and names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.__call__">__call__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Execute model inference while maintaining input and model device synchronization.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.__getattr__">__getattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Transparently proxy attribute access to the underlying model when not found in Meter instance.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.__setattr__">__setattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Prioritize setting attributes on Meter instance first, falling back to the underlying model.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.__delattr__">__delattr__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Try to delete attributes from Meter instance first, fall back to underlying model if needed.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.to">to</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Move the model to the specified device while keeping input and model device synchronization.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.profile">profile</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Render a tabular report of the specified statistics with rich visualization.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.table_cols">table_cols</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get all column names of the backend dataframe for the specified statistics.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.stat_info">stat_info</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a formatted summary of the specified statistics.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.overview">overview</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates an overview of all statistics in a formatted layout.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter.rebase">rebase</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Rebases the Meter instance to a specific node in the operation tree.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Requires at least one forward pass before most measurements become available.</li>
<li>Implements lazy evaluation and cache for most statistics (i.e. <code>param</code>, <code>cal</code>, <code>mem</code>).</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span><span class="p">,</span> <span class="n">get_config</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1"># prepare your torch model</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet152</span><span class="p">()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1"># wrap the model with Meter class</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="c1"># Basic usage</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>  <span class="c1"># Standard model execution</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="c1"># Performance analysis</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>  <span class="c1"># Visualize model hierarchy</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>  <span class="c1"># Show parameter statistics</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="s2">&quot;cal&quot;</span><span class="p">)</span>  <span class="c1"># Display computational cost table</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="c1"># Automatic device synchronization</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a>    <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a>    <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div>
</details>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>PyTorch</code> model to be instrumented for measurement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.device">device</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target device for model execution and measurement.
                                         Accepts either device string (e.g., <code>cuda:0</code>) or
                                         <code>torch.device</code> object. If <code>None</code>, automatically detects
                                         model's current device via its parameters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided model is not a <code>nn.Module</code> instance</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="UserWarning">UserWarning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When device is not specified and model contains no parameters (fallback to <code>CPU</code>)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Initialization performs following key operations:</p>
<ol>
<li>
<p>Device configuration:</p>
<ul>
<li>Uses specified device or auto-detects via model parameters</li>
<li>Moves model to target device</li>
</ul>
</li>
<li>
<p>Measurement infrastructure setup:</p>
<ul>
<li>Initializes input capture dictionary (<code>_ipt</code>)</li>
<li>Builds operation tree (<code>optree</code>) for model structure analysis</li>
<li>Prepares renderers for visualization (<code>tree_renderer</code>, <code>table_renderer</code>)</li>
</ul>
</li>
<li>
<p>Measurement state initialization:</p>
<ul>
<li>Resets measurement flags (<code>param</code>/<code>cal</code>/<code>mem</code>)</li>
<li>Sets default benchmark parameters (<code>ittp_warmup</code>=50, <code>ittp_benchmark_time</code>=100)</li>
<li>Initializes accuracy warning trackers (<code>_has_nocall_nodes</code>, <code>_has_not_support_nodes</code>)</li>
</ul>
</li>
</ol>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1"># auto detect device</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1"># init a gpu model</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:1&quot;</span><span class="p">)</span>
</code></pre></div>
</details>






                  <details class="quote">
                    <summary>Source code in <code>torchmeter/core.py</code></summary>
                    <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-185" name="__codelineno-0-185"></a><a href="#__codelineno-0-185"><span class="linenos" data-linenos="185 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tc_device</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><a href="#__codelineno-0-186"><span class="linenos" data-linenos="186 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a Meter instance for model performance measurement and visualization.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><a href="#__codelineno-0-187"><span class="linenos" data-linenos="187 "></span></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><a href="#__codelineno-0-188"><span class="linenos" data-linenos="188 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><a href="#__codelineno-0-189"><span class="linenos" data-linenos="189 "></span></a><span class="sd">        model (nn.Module): `PyTorch` model to be instrumented for measurement</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><a href="#__codelineno-0-190"><span class="linenos" data-linenos="190 "></span></a><span class="sd">        device (Optional[Union[str, torch.device]]): Target device for model execution and measurement.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><a href="#__codelineno-0-191"><span class="linenos" data-linenos="191 "></span></a><span class="sd">                                                     Accepts either device string (e.g., `cuda:0`) or</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><a href="#__codelineno-0-192"><span class="linenos" data-linenos="192 "></span></a><span class="sd">                                                     `torch.device` object. If `None`, automatically detects</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><a href="#__codelineno-0-193"><span class="linenos" data-linenos="193 "></span></a><span class="sd">                                                     model&#39;s current device via its parameters.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><a href="#__codelineno-0-194"><span class="linenos" data-linenos="194 "></span></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><a href="#__codelineno-0-195"><span class="linenos" data-linenos="195 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><a href="#__codelineno-0-196"><span class="linenos" data-linenos="196 "></span></a><span class="sd">        TypeError: If provided model is not a `nn.Module` instance</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><a href="#__codelineno-0-197"><span class="linenos" data-linenos="197 "></span></a><span class="sd">        UserWarning: When device is not specified and model contains no parameters (fallback to `CPU`)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><a href="#__codelineno-0-198"><span class="linenos" data-linenos="198 "></span></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><a href="#__codelineno-0-199"><span class="linenos" data-linenos="199 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><a href="#__codelineno-0-200"><span class="linenos" data-linenos="200 "></span></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><a href="#__codelineno-0-201"><span class="linenos" data-linenos="201 "></span></a><span class="sd">    Initialization performs following key operations:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><a href="#__codelineno-0-202"><span class="linenos" data-linenos="202 "></span></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><a href="#__codelineno-0-203"><span class="linenos" data-linenos="203 "></span></a><span class="sd">    1. Device configuration:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><a href="#__codelineno-0-204"><span class="linenos" data-linenos="204 "></span></a><span class="sd">        - Uses specified device or auto-detects via model parameters</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><a href="#__codelineno-0-205"><span class="linenos" data-linenos="205 "></span></a><span class="sd">        - Moves model to target device</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><a href="#__codelineno-0-206"><span class="linenos" data-linenos="206 "></span></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><a href="#__codelineno-0-207"><span class="linenos" data-linenos="207 "></span></a><span class="sd">    2. Measurement infrastructure setup:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><a href="#__codelineno-0-208"><span class="linenos" data-linenos="208 "></span></a><span class="sd">        - Initializes input capture dictionary (`_ipt`)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><a href="#__codelineno-0-209"><span class="linenos" data-linenos="209 "></span></a><span class="sd">        - Builds operation tree (`optree`) for model structure analysis</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><a href="#__codelineno-0-210"><span class="linenos" data-linenos="210 "></span></a><span class="sd">        - Prepares renderers for visualization (`tree_renderer`, `table_renderer`)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><a href="#__codelineno-0-211"><span class="linenos" data-linenos="211 "></span></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><a href="#__codelineno-0-212"><span class="linenos" data-linenos="212 "></span></a><span class="sd">    3. Measurement state initialization:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><a href="#__codelineno-0-213"><span class="linenos" data-linenos="213 "></span></a><span class="sd">        - Resets measurement flags (`param`/`cal`/`mem`)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><a href="#__codelineno-0-214"><span class="linenos" data-linenos="214 "></span></a><span class="sd">        - Sets default benchmark parameters (`ittp_warmup`=50, `ittp_benchmark_time`=100)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><a href="#__codelineno-0-215"><span class="linenos" data-linenos="215 "></span></a><span class="sd">        - Initializes accuracy warning trackers (`_has_nocall_nodes`, `_has_not_support_nodes`)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><a href="#__codelineno-0-216"><span class="linenos" data-linenos="216 "></span></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><a href="#__codelineno-0-217"><span class="linenos" data-linenos="217 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><a href="#__codelineno-0-218"><span class="linenos" data-linenos="218 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><a href="#__codelineno-0-219"><span class="linenos" data-linenos="219 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><a href="#__codelineno-0-220"><span class="linenos" data-linenos="220 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><a href="#__codelineno-0-221"><span class="linenos" data-linenos="221 "></span></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><a href="#__codelineno-0-222"><span class="linenos" data-linenos="222 "></span></a><span class="sd">        underlying_model = models.resnet18()</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><a href="#__codelineno-0-223"><span class="linenos" data-linenos="223 "></span></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><a href="#__codelineno-0-224"><span class="linenos" data-linenos="224 "></span></a><span class="sd">        # auto detect device</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><a href="#__codelineno-0-225"><span class="linenos" data-linenos="225 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><a href="#__codelineno-0-226"><span class="linenos" data-linenos="226 "></span></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><a href="#__codelineno-0-227"><span class="linenos" data-linenos="227 "></span></a><span class="sd">        # init a gpu model</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><a href="#__codelineno-0-228"><span class="linenos" data-linenos="228 "></span></a><span class="sd">        model = Meter(underlying_model, device=&quot;cuda&quot;)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><a href="#__codelineno-0-229"><span class="linenos" data-linenos="229 "></span></a><span class="sd">        model = Meter(underlying_model, device=&quot;cuda:1&quot;)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><a href="#__codelineno-0-230"><span class="linenos" data-linenos="230 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><a href="#__codelineno-0-231"><span class="linenos" data-linenos="231 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><a href="#__codelineno-0-232"><span class="linenos" data-linenos="232 "></span></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><a href="#__codelineno-0-233"><span class="linenos" data-linenos="233 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter.engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">OperationTree</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><a href="#__codelineno-0-234"><span class="linenos" data-linenos="234 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">TreeRenderer</span><span class="p">,</span> <span class="n">TabularRenderer</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><a href="#__codelineno-0-235"><span class="linenos" data-linenos="235 "></span></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><a href="#__codelineno-0-236"><span class="linenos" data-linenos="236 "></span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><a href="#__codelineno-0-237"><span class="linenos" data-linenos="237 "></span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;model must be a nn.Module, but got `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><a href="#__codelineno-0-238"><span class="linenos" data-linenos="238 "></span></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><a href="#__codelineno-0-239"><span class="linenos" data-linenos="239 "></span></a>    <span class="n">device</span> <span class="o">=</span> <span class="n">device</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device_detect</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><a href="#__codelineno-0-240"><span class="linenos" data-linenos="240 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__device</span> <span class="o">=</span> <span class="n">tc_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">device</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><a href="#__codelineno-0-241"><span class="linenos" data-linenos="241 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><a href="#__codelineno-0-242"><span class="linenos" data-linenos="242 "></span></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><a href="#__codelineno-0-243"><span class="linenos" data-linenos="243 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">:</span> <span class="n">IPT_TYPE</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(),</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()}</span>  <span class="c1"># TODO: self.ipt_infer()</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><a href="#__codelineno-0-244"><span class="linenos" data-linenos="244 "></span></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><a href="#__codelineno-0-245"><span class="linenos" data-linenos="245 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">optree</span> <span class="o">=</span> <span class="n">OperationTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><a href="#__codelineno-0-246"><span class="linenos" data-linenos="246 "></span></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><a href="#__codelineno-0-247"><span class="linenos" data-linenos="247 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tree_renderer</span> <span class="o">=</span> <span class="n">TreeRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><a href="#__codelineno-0-248"><span class="linenos" data-linenos="248 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">table_renderer</span> <span class="o">=</span> <span class="n">TabularRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><a href="#__codelineno-0-249"><span class="linenos" data-linenos="249 "></span></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><a href="#__codelineno-0-250"><span class="linenos" data-linenos="250 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__measure_param</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><a href="#__codelineno-0-251"><span class="linenos" data-linenos="251 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__measure_cal</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><a href="#__codelineno-0-252"><span class="linenos" data-linenos="252 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__measure_mem</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><a href="#__codelineno-0-253"><span class="linenos" data-linenos="253 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ittp_warmup</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><a href="#__codelineno-0-254"><span class="linenos" data-linenos="254 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ittp_benchmark_time</span> <span class="o">=</span> <span class="mi">100</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><a href="#__codelineno-0-255"><span class="linenos" data-linenos="255 "></span></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><a href="#__codelineno-0-256"><span class="linenos" data-linenos="256 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__has_nocall_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><a href="#__codelineno-0-257"><span class="linenos" data-linenos="257 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">__has_not_support_nodes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.cal" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">cal</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.cal" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cal</span><span class="p">:</span> <span class="n">CalMeter</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Measures the calculation cost of the model during inference.</p>
<p>This property calculates the computational cost (i.e., <code>FLOPs</code> and <code>MACs</code>) for each node in the
operation tree during a feed-forward inference pass.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>CalMeter</code></td>            <td>
                  <code><span title="torchmeter.statistic.CalMeter">CalMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A CalMeter instance containing the measured computational cost data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no input data has been provided (i.e., <code>self._ipt</code> is empty).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>You must first invoke the Meter instance (via a forward pass) before accessing this property.</p>
</li>
<li>
<p>The measurement is performed only once for each Meter instance. Subsequent accesses
  will return the cached result.</p>
</li>
<li>
<p>The measurement results depend on the model input, and different input tensor sizes
  will lead to varying calculation costs, which is <strong>normal</strong>. For consistent and comparable
  results, we recommend using <strong>a single sample</strong> for measuring all statistics including <code>cal</code>.
  This can be achieved by providing a single-sample forward pass to the meter instance whenever
  you want.</p>
</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.device" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">device</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#torchmeter.core.Meter.device" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">device</span><span class="p">:</span> <span class="n">device</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>The device where the model and all input tensors are currently located.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.device">device</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>torch.device: Current device as a torch.device object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.ipt" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ipt</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.ipt" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ipt</span><span class="p">:</span> <span class="n">IPT_TYPE</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Captured underlying model input dictionary.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torchmeter.core.IPT_TYPE">IPT_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, Any]: A dictionary containing the captured model input.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>This property is read-only and cannot be directly modified</p>
</li>
<li>
<p>Returned dictionary containing:</p>
<ul>
<li><code>args</code> (<code>tuple</code>): Positional arguments passed to the <code>forward()</code> of the underlying model.</li>
<li><code>kwargs</code> (<code>dict</code>): Keyword arguments passed to the <code>forward()</code> of the underlying model</li>
</ul>
</li>
<li>
<p>Input can only be set/updated through <code>Meter</code> instance calls
  (i.e., feed-forward inference of the origin model)</p>
</li>
<li>
<p>If there exists tensor data, its dimensions might directly impact the measurement results
  of multiple statistics (e.g. <code>cal</code>, <code>mem</code>, <code>ittp</code>). For consistent and comparable results,
  we recommend using <strong>a single sample</strong> for measuring all statistics. This can be achieved
  by providing a single-sample forward pass to the meter instance whenever you want.</p>
</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.ittp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ittp</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.ittp" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ittp</span><span class="p">:</span> <span class="n">IttpMeter</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Measures the inference time and throughput of the model.</p>
<p>This property calculates the inference time and throughput for each node in the operation tree.
It performs a warm-up phase followed by a benchmark phase to ensure accurate measurements.
The results are returned as an <code>IttpMeter</code> object.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>IttpMeter</code></td>            <td>
                  <code><span title="torchmeter.statistic.IttpMeter">IttpMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A IttpMeter instance containing fresh inference time and throughput data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no input data has been provided (i.e., <code>self._ipt</code> is empty).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>self.ittp_warmup</code> is not an integer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>self.ittp_warmup</code> is a negative integer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>You must first invoke the Meter instance (via a forward pass) before accessing this property.</p>
</li>
<li>
<p>The measurements are performed on the device specified by <code>meter_instance.device</code> !!!</p>
</li>
<li>
<p>The unit <code>IPS</code> means <strong>Input Per Second</strong>, which is the number of inferences with given input
  per second.</p>
</li>
<li>
<p>Unlike other statistics, the measured result is <strong>not</strong> cached, so it will be
  re-measured every time <code>ittp</code> attribute is accessed.</p>
</li>
<li>
<p>The warm-up phase runs for <code>meter_instance.ittp_warmup</code> iterations to stabilize the measurements.</p>
</li>
<li>
<p>The benchmark phase runs for <code>meter_instance.ittp_benchmark_time</code> iterations per operation.</p>
</li>
<li>
<p>The measurement results depend on the model input, and different input tensor sizes will lead to
  varying latencies and throughput, which is <strong>normal</strong>. For consistent and comparable results, we
  recommend using <strong>a single sample</strong> for measuring all statistics including <code>ittp</code>. This can be
  achieved by providing a single-sample forward pass to the meter instance whenever you want.</p>
</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.mem" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mem</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.mem" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">mem</span><span class="p">:</span> <span class="n">MemMeter</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Measures the memory cost of the model during inference.</p>
<p>This property calculates the memory usage for each node in the operation tree during a
feed-forward inference pass.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MemMeter</code></td>            <td>
                  <code><span title="torchmeter.statistic.MemMeter">MemMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A MemMeter instance containing the measured memory usage data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no input data has been provided (i.e., <code>self._ipt</code> is empty).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>You must first invoke the Meter instance (via a forward pass) before accessing this property.</p>
</li>
<li>
<p>The measurement is performed only once for each Meter instance. Subsequent accesses
  will return the cached result.</p>
</li>
<li>
<p>The measurement results depend on the model input, and different input tensor sizes
  will lead to varying memory costs, which is <strong>normal</strong>. For consistent and comparable
  results, we recommend using <strong>a single sample</strong> for measuring all statistics including
  <code>mem</code>. This can be achieved by providing a single-sample forward pass to the meter instance
  whenever you want.</p>
</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.model_info" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">model_info</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.model_info" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">model_info</span><span class="p">:</span> <span class="n">Text</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates a formatted summary of the model's basic information.</p>
<p>This property provides a detailed summary of the model, including its name, device,
forward method signature, and structured input representation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Text</code></td>            <td>
                  <code><span title="rich.text.Text">Text</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>rich.Text</code> object containing the formatted model information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>If no input has been provided (i.e., <code>self._ipt</code> is empty), the input representation will
indicate that it is not provided.</p>
</li>
<li>
<p>Otherwise, all the values in <code>self._ipt</code> will correspond to the formal arguments of the
<code>forward</code> method, and a structured input representation with type prompts will be generated
through the <code>torchmeter.utils.data_repr</code> function.</p>
</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.param" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">param</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.param" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">param</span><span class="p">:</span> <span class="n">ParamsMeter</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Measures the number of model parameters.</p>
<p>This property calculates the parameter-related metrics (e.g., number of parameters,
trainable parameters) for each node in the operation tree.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ParamsMeter</code></td>            <td>
                  <code><span title="torchmeter.statistic.ParamsMeter">ParamsMeter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ParamsMeter instance containing the measured parameter-related statistics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The measurement is performed only once for each Meter instance. Subsequent accesses
will return the cached result.</p>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.structure" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">structure</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.structure" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">structure</span><span class="p">:</span> <span class="n">Tree</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate a stylized tree representation of the model's operation hierarchy.</p>
<p>This property renders the operation tree based on current configuration settings.
The rendering strategy (folded/unfolded) and customization options are determined
by the active configuration parameters. Caching is applied to optimize rendering
performance when configuration remains unchanged.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Tree</code></td>            <td>
                  <code><span title="rich.tree.Tree">Tree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>rich.tree.Tree</code> object representing the hierarchical structure of model operations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>Configuration parameters influence rendering behavior, you can access them directly
  by <code>metered_model.&lt;param_name&gt;</code></p>
<ul>
<li><code>tree_fold_repeat</code>: Controls whether a repeated block is rendered as a single block.
                      Default to True.</li>
<li><code>tree_levels_args</code>: Customizes rendering at different tree levels.</li>
<li><code>tree_repeat_block_args</code>: Detailed parameters to control the rendering of the repeat blocks.</li>
</ul>
</li>
<li>
<p>Caching mechanism: Reuses cached render result if all configuration parameters remain
  unchanged since last render.</p>
</li>
<li>
<p>For information on repeated blocks identification and rendering, please refer to the
  description of <code>Meter.tree_fold_repeat</code> property.</p>
</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">vit_b_16</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># use the default configuration</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># reaccess the structure, will be quickly returned</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="c1"># use a custom configuration</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">tree_fold_repeat</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">tree_levels_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;guide_style&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
</code></pre></div>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.subnodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">subnodes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#torchmeter.core.Meter.subnodes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">subnodes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves a list of all nodes in the operation tree with their IDs and names.</p>
<p>This property returns a formatted list of all nodes in the operation tree, where each node is
represented by its ID and name. This is useful for identifying specific nodes when rebasing or
inspecting the tree structure.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of strings, each formatted as <code>(node_id) node_name</code>, representing all nodes
       in the operation tree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.table_column_args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">table_column_args</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#torchmeter.core.Meter.table_column_args" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">table_column_args</span><span class="p">:</span> <span class="n">FlagNameSpace</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Gets column rendering configuration for rendered tables.</p>
<p>This property directly binds to <code>torchmeter.display.TabularRenderer.col_args</code>
to get column-level rendering configuration (e.g., style, justify) for tables
generated via <code>Meter.profile()</code>. The configuration persists across all subsequent
table renderings until explicitly modified.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FlagNameSpace</code></td>            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A namespace containing concrete configuration names.
           Accessible keys match valid arguments of <code>rich.table.Column</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.table_display_args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">table_display_args</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#torchmeter.core.Meter.table_display_args" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">table_display_args</span><span class="p">:</span> <span class="n">FlagNameSpace</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Gets comprehensive rendering configuration for rendered tables.</p>
<p>This property directly binds to <code>torchmeter.display.TabularRenderer.tb_args</code>
to get rendering configuration (e.g., style, highlight) for tables generated
via <code>Meter.profile()</code>. The configuration persists across all subsequent table
renderings until explicitly modified.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FlagNameSpace</code></td>            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A namespace containing concrete configuration names.
           Accessible keys match valid arguments of <code>rich.table.Table</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.tree_fold_repeat" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tree_fold_repeat</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#torchmeter.core.Meter.tree_fold_repeat" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tree_fold_repeat</span><span class="p">:</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Controls whether repeated tree blocks are rendered as collapsed panels.</p>
<p>This property directly binds to the <code>tree_fold_repeat</code> property in the global configuration.
When enabled, repeated operation blocks are collapsed into a single panel during tree rendering
via <code>Meter.structure</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True to collapse repeated blocks, False to expand them.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>
<p>Repeated blocks are identified only when two operations exhibit structural equivalence in:</p>
<ol>
<li>Their own parameter signatures</li>
<li>Their child operations' hierarchical parameters</li>
<li>The execution order within the operation if it is a container.</li>
</ol>
</li>
<li>
<p>The folding feature activates exclusively for such validated repetitive patterns.
  All other structures render sequentially following their topological order.</p>
</li>
<li>
<p>If your model doesn't have the repeated blocks mentioned above (like <code>AlexNet</code>),
  setting this property True or False won't affect the output.</p>
</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.tree_levels_args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tree_levels_args</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#torchmeter.core.Meter.tree_levels_args" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tree_levels_args</span><span class="p">:</span> <span class="n">FlagNameSpace</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Gets rendering configuration for various levels of rendered tree structure.</p>
<p>This property directly binds to <code>torchmeter.display.TreeRenderer.tree_levels_args</code>
to get rendering configuration (e.g., label, guide_style) for various levels of rendered
tree structure generated via <code>Meter.structure</code> property. The configuration persists across
all subsequent tree renderings until explicitly modified.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FlagNameSpace</code></td>            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A nested namespace where the outer-layer keys are the specific tree levels,
           and the values are the configuration namespaces for the corresponding levels.
           In each configuration namespace, the keys contain the specific configuration names,
           which match the valid parameters of <code>rich.tree.Tree</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="torchmeter.core.Meter.tree_repeat_block_args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">tree_repeat_block_args</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#torchmeter.core.Meter.tree_repeat_block_args" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tree_repeat_block_args</span><span class="p">:</span> <span class="n">FlagNameSpace</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Gets rendering configuration for repeated blocks of rendered tree structure.</p>
<p>This property directly binds to <code>torchmeter.display.TreeRenderer.repeat_block_args</code>
to get rendering configuration (e.g., <code>style</code>, <code>highlight</code>) for repeated blocks of rendered
tree structure generated via <code>Meter.structure</code> property. The configuration persists across
all subsequent tree renderings until explicitly modified.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FlagNameSpace</code></td>            <td>
                  <code><span title="torchmeter.config.FlagNameSpace">FlagNameSpace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A namespace containing concrete configuration names.
           Accessible keys match valid arguments of <code>rich.panel.Panel</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__call__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__call__</span>


<a href="#torchmeter.core.Meter.__call__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="nf">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Execute model inference while maintaining input and model device synchronization.</p>
<p>This method performs three key operations in order:</p>
<ol>
<li>Captures input arguments of underlying model's <code>forward</code> method for measurement purposes</li>
<li>Align the device where the input tensor is located with the device where the model on.</li>
<li>Executes the underlying model's feed-forward inference</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments of the underlying model's <code>forward</code> method</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments of the underlying model's <code>forward</code> method</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output from the underlying model's feed-forward inference</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input data is needed but not provided.
          (triggered by <code>_ipt2device()</code> method).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>From a macroscopic perspective, this is equivalent to direct model invocation:
    <code>meter_instance(input)</code> == <code>model(input)</code></p>
</li>
<li>
<p>You can safely input tensors from different devices; automatic synchronization is handled:</p>
<ul>
<li>Moves all tensors in the input to current device via <code>_ipt2device()</code></li>
<li>Ensures model is on current device before execution</li>
</ul>
</li>
<li>
<p>Subsequent calls perform two key operations:</p>
<ol>
<li>Overwrite captured inputs, enabling <code>ipt</code> updates through normal model invocation</li>
<li>Clear cached measurements when input differs (determined by <code>Meter.__is_ipt_changed()</code> rules)</li>
</ol>
</li>
<li>
<p>If there exists tensor data, its dimensions might directly impact the measurement results
  of multiple statistics (e.g. <code>cal</code>, <code>mem</code>, <code>ittp</code>). For consistent and comparable results,
  we recommend using <strong>a single sample</strong> for measuring all statistics. This can be achieved
  by passing in a single batch of sample data whenever you want.</p>
</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="c1"># Standard invocation</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="c1"># Mixed argument types</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-259" name="__codelineno-0-259"></a><a href="#__codelineno-0-259"><span class="linenos" data-linenos="259 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><a href="#__codelineno-0-260"><span class="linenos" data-linenos="260 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute model inference while maintaining input and model device synchronization.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><a href="#__codelineno-0-261"><span class="linenos" data-linenos="261 "></span></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><a href="#__codelineno-0-262"><span class="linenos" data-linenos="262 "></span></a><span class="sd">    This method performs three key operations in order:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><a href="#__codelineno-0-263"><span class="linenos" data-linenos="263 "></span></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><a href="#__codelineno-0-264"><span class="linenos" data-linenos="264 "></span></a><span class="sd">    1. Captures input arguments of underlying model&#39;s `forward` method for measurement purposes</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><a href="#__codelineno-0-265"><span class="linenos" data-linenos="265 "></span></a><span class="sd">    2. Align the device where the input tensor is located with the device where the model on.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><a href="#__codelineno-0-266"><span class="linenos" data-linenos="266 "></span></a><span class="sd">    3. Executes the underlying model&#39;s feed-forward inference</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><a href="#__codelineno-0-267"><span class="linenos" data-linenos="267 "></span></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><a href="#__codelineno-0-268"><span class="linenos" data-linenos="268 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><a href="#__codelineno-0-269"><span class="linenos" data-linenos="269 "></span></a><span class="sd">        *args: Positional arguments of the underlying model&#39;s `forward` method</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><a href="#__codelineno-0-270"><span class="linenos" data-linenos="270 "></span></a><span class="sd">        **kwargs: Keyword arguments of the underlying model&#39;s `forward` method</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><a href="#__codelineno-0-271"><span class="linenos" data-linenos="271 "></span></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><a href="#__codelineno-0-272"><span class="linenos" data-linenos="272 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><a href="#__codelineno-0-273"><span class="linenos" data-linenos="273 "></span></a><span class="sd">        Any: Output from the underlying model&#39;s feed-forward inference</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><a href="#__codelineno-0-274"><span class="linenos" data-linenos="274 "></span></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><a href="#__codelineno-0-275"><span class="linenos" data-linenos="275 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><a href="#__codelineno-0-276"><span class="linenos" data-linenos="276 "></span></a><span class="sd">        RuntimeError: If input data is needed but not provided.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><a href="#__codelineno-0-277"><span class="linenos" data-linenos="277 "></span></a><span class="sd">                      (triggered by `_ipt2device()` method).</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><a href="#__codelineno-0-278"><span class="linenos" data-linenos="278 "></span></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><a href="#__codelineno-0-279"><span class="linenos" data-linenos="279 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><a href="#__codelineno-0-280"><span class="linenos" data-linenos="280 "></span></a><span class="sd">        - From a macroscopic perspective, this is equivalent to direct model invocation:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><a href="#__codelineno-0-281"><span class="linenos" data-linenos="281 "></span></a><span class="sd">            `meter_instance(input)` == `model(input)`</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><a href="#__codelineno-0-282"><span class="linenos" data-linenos="282 "></span></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><a href="#__codelineno-0-283"><span class="linenos" data-linenos="283 "></span></a><span class="sd">        - You can safely input tensors from different devices; automatic synchronization is handled:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><a href="#__codelineno-0-284"><span class="linenos" data-linenos="284 "></span></a><span class="sd">            - Moves all tensors in the input to current device via `_ipt2device()`</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><a href="#__codelineno-0-285"><span class="linenos" data-linenos="285 "></span></a><span class="sd">            - Ensures model is on current device before execution</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><a href="#__codelineno-0-286"><span class="linenos" data-linenos="286 "></span></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><a href="#__codelineno-0-287"><span class="linenos" data-linenos="287 "></span></a><span class="sd">        - Subsequent calls perform two key operations:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><a href="#__codelineno-0-288"><span class="linenos" data-linenos="288 "></span></a><span class="sd">            1. Overwrite captured inputs, enabling `ipt` updates through normal model invocation</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><a href="#__codelineno-0-289"><span class="linenos" data-linenos="289 "></span></a><span class="sd">            2. Clear cached measurements when input differs (determined by `Meter.__is_ipt_changed()` rules)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><a href="#__codelineno-0-290"><span class="linenos" data-linenos="290 "></span></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><a href="#__codelineno-0-291"><span class="linenos" data-linenos="291 "></span></a><span class="sd">        - If there exists tensor data, its dimensions might directly impact the measurement results</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><a href="#__codelineno-0-292"><span class="linenos" data-linenos="292 "></span></a><span class="sd">          of multiple statistics (e.g. `cal`, `mem`, `ittp`). For consistent and comparable results,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><a href="#__codelineno-0-293"><span class="linenos" data-linenos="293 "></span></a><span class="sd">          we recommend using **a single sample** for measuring all statistics. This can be achieved</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><a href="#__codelineno-0-294"><span class="linenos" data-linenos="294 "></span></a><span class="sd">          by passing in a single batch of sample data whenever you want.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><a href="#__codelineno-0-295"><span class="linenos" data-linenos="295 "></span></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><a href="#__codelineno-0-296"><span class="linenos" data-linenos="296 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><a href="#__codelineno-0-297"><span class="linenos" data-linenos="297 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><a href="#__codelineno-0-298"><span class="linenos" data-linenos="298 "></span></a><span class="sd">        import torch</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><a href="#__codelineno-0-299"><span class="linenos" data-linenos="299 "></span></a><span class="sd">        import torch.nn as nn</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><a href="#__codelineno-0-300"><span class="linenos" data-linenos="300 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><a href="#__codelineno-0-301"><span class="linenos" data-linenos="301 "></span></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><a href="#__codelineno-0-302"><span class="linenos" data-linenos="302 "></span></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><a href="#__codelineno-0-303"><span class="linenos" data-linenos="303 "></span></a><span class="sd">        class MyModel(nn.Module):</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><a href="#__codelineno-0-304"><span class="linenos" data-linenos="304 "></span></a><span class="sd">            def __init__(self):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><a href="#__codelineno-0-305"><span class="linenos" data-linenos="305 "></span></a><span class="sd">                super(MyModel, self).__init__()</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><a href="#__codelineno-0-306"><span class="linenos" data-linenos="306 "></span></a><span class="sd">                self.conv = nn.Conv2d(3, 10, 3)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><a href="#__codelineno-0-307"><span class="linenos" data-linenos="307 "></span></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><a href="#__codelineno-0-308"><span class="linenos" data-linenos="308 "></span></a><span class="sd">            def forward(self, x, y=1):</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><a href="#__codelineno-0-309"><span class="linenos" data-linenos="309 "></span></a><span class="sd">                return self.conv(x) + y</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><a href="#__codelineno-0-310"><span class="linenos" data-linenos="310 "></span></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><a href="#__codelineno-0-311"><span class="linenos" data-linenos="311 "></span></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><a href="#__codelineno-0-312"><span class="linenos" data-linenos="312 "></span></a><span class="sd">        underlying_model = MyModel()</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><a href="#__codelineno-0-313"><span class="linenos" data-linenos="313 "></span></a><span class="sd">        model = Meter(underlying_model, device=&quot;cuda:0&quot;)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><a href="#__codelineno-0-314"><span class="linenos" data-linenos="314 "></span></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><a href="#__codelineno-0-315"><span class="linenos" data-linenos="315 "></span></a><span class="sd">        # Standard invocation</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><a href="#__codelineno-0-316"><span class="linenos" data-linenos="316 "></span></a><span class="sd">        output = model(torch.randn(1, 3, 224, 224))</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><a href="#__codelineno-0-317"><span class="linenos" data-linenos="317 "></span></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><a href="#__codelineno-0-318"><span class="linenos" data-linenos="318 "></span></a><span class="sd">        # Mixed argument types</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><a href="#__codelineno-0-319"><span class="linenos" data-linenos="319 "></span></a><span class="sd">        output = model(torch.randn(1, 3, 224, 224), y=2)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><a href="#__codelineno-0-320"><span class="linenos" data-linenos="320 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><a href="#__codelineno-0-321"><span class="linenos" data-linenos="321 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><a href="#__codelineno-0-322"><span class="linenos" data-linenos="322 "></span></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><a href="#__codelineno-0-323"><span class="linenos" data-linenos="323 "></span></a>    <span class="n">new_ipt</span><span class="p">:</span> <span class="n">IPT_TYPE</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">args</span><span class="p">,</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">}</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><a href="#__codelineno-0-324"><span class="linenos" data-linenos="324 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__is_ipt_changed</span><span class="p">(</span><span class="n">new_ipt</span><span class="p">):</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><a href="#__codelineno-0-325"><span class="linenos" data-linenos="325 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__measure_param</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><a href="#__codelineno-0-326"><span class="linenos" data-linenos="326 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__measure_cal</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><a href="#__codelineno-0-327"><span class="linenos" data-linenos="327 "></span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__measure_mem</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><a href="#__codelineno-0-328"><span class="linenos" data-linenos="328 "></span></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><a href="#__codelineno-0-329"><span class="linenos" data-linenos="329 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span> <span class="o">=</span> <span class="n">new_ipt</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><a href="#__codelineno-0-330"><span class="linenos" data-linenos="330 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_ipt2device</span><span class="p">()</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><a href="#__codelineno-0-331"><span class="linenos" data-linenos="331 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><a href="#__codelineno-0-332"><span class="linenos" data-linenos="332 "></span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">])</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__delattr__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__delattr__</span>


<a href="#torchmeter.core.Meter.__delattr__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="fm">__delattr__</span><span class="p">(</span><span class="nf">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Try to delete attributes from Meter instance first, fall back to underlying model if needed.</p>
<p>This method ensures:</p>
<ol>
<li>Class attributes defined in <code>Meter</code> cannot be deleted</li>
<li>Instance attributes are deleted along with corresponding model attributes (if exists)</li>
<li>Attributes prefixed with "ORIGIN_" will delete the actual model attribute after removing prefix</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the attribute to delete</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>When trying to delete Meter's class attributes</li>
<li>When attempting to delete non-existent attributes</li>
<li>When failed to delete attribute from both Meter instance and the underlying model</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>When encountering conflicting attribute names between Meter instance and the model:
    The Meter instance's attribute will be prioritized for deletion by default.
    To delete the underlying model's attribute with same name, prepend "ORIGIN_" prefix.
    Example: <code>del meter_instance.ORIGIN_param</code> will delete model's <code>param</code> attribute</p>
</li>
<li>
<p>This implementation ensures the Meter instance can be seamlessly used as a drop-in replacement
  for the underlying model without requiring code modifications</p>
</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-431" name="__codelineno-0-431"></a><a href="#__codelineno-0-431"><span class="linenos" data-linenos="431 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><a href="#__codelineno-0-432"><span class="linenos" data-linenos="432 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Try to delete attributes from Meter instance first, fall back to underlying model if needed.</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><a href="#__codelineno-0-433"><span class="linenos" data-linenos="433 "></span></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><a href="#__codelineno-0-434"><span class="linenos" data-linenos="434 "></span></a><span class="sd">    This method ensures:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><a href="#__codelineno-0-435"><span class="linenos" data-linenos="435 "></span></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><a href="#__codelineno-0-436"><span class="linenos" data-linenos="436 "></span></a><span class="sd">    1. Class attributes defined in `Meter` cannot be deleted</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><a href="#__codelineno-0-437"><span class="linenos" data-linenos="437 "></span></a><span class="sd">    2. Instance attributes are deleted along with corresponding model attributes (if exists)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><a href="#__codelineno-0-438"><span class="linenos" data-linenos="438 "></span></a><span class="sd">    3. Attributes prefixed with &quot;ORIGIN_&quot; will delete the actual model attribute after removing prefix</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><a href="#__codelineno-0-439"><span class="linenos" data-linenos="439 "></span></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><a href="#__codelineno-0-440"><span class="linenos" data-linenos="440 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><a href="#__codelineno-0-441"><span class="linenos" data-linenos="441 "></span></a><span class="sd">        name (str): Name of the attribute to delete</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><a href="#__codelineno-0-442"><span class="linenos" data-linenos="442 "></span></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><a href="#__codelineno-0-443"><span class="linenos" data-linenos="443 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><a href="#__codelineno-0-444"><span class="linenos" data-linenos="444 "></span></a><span class="sd">        AttributeError:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><a href="#__codelineno-0-445"><span class="linenos" data-linenos="445 "></span></a><span class="sd">            - When trying to delete Meter&#39;s class attributes</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><a href="#__codelineno-0-446"><span class="linenos" data-linenos="446 "></span></a><span class="sd">            - When attempting to delete non-existent attributes</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><a href="#__codelineno-0-447"><span class="linenos" data-linenos="447 "></span></a><span class="sd">            - When failed to delete attribute from both Meter instance and the underlying model</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><a href="#__codelineno-0-448"><span class="linenos" data-linenos="448 "></span></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><a href="#__codelineno-0-449"><span class="linenos" data-linenos="449 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><a href="#__codelineno-0-450"><span class="linenos" data-linenos="450 "></span></a><span class="sd">        - When encountering conflicting attribute names between Meter instance and the model:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><a href="#__codelineno-0-451"><span class="linenos" data-linenos="451 "></span></a><span class="sd">            The Meter instance&#39;s attribute will be prioritized for deletion by default.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><a href="#__codelineno-0-452"><span class="linenos" data-linenos="452 "></span></a><span class="sd">            To delete the underlying model&#39;s attribute with same name, prepend &quot;ORIGIN_&quot; prefix.</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><a href="#__codelineno-0-453"><span class="linenos" data-linenos="453 "></span></a><span class="sd">            Example: `del meter_instance.ORIGIN_param` will delete model&#39;s `param` attribute</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><a href="#__codelineno-0-454"><span class="linenos" data-linenos="454 "></span></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><a href="#__codelineno-0-455"><span class="linenos" data-linenos="455 "></span></a><span class="sd">        - This implementation ensures the Meter instance can be seamlessly used as a drop-in replacement</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><a href="#__codelineno-0-456"><span class="linenos" data-linenos="456 "></span></a><span class="sd">          for the underlying model without requiring code modifications</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><a href="#__codelineno-0-457"><span class="linenos" data-linenos="457 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><a href="#__codelineno-0-458"><span class="linenos" data-linenos="458 "></span></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><a href="#__codelineno-0-459"><span class="linenos" data-linenos="459 "></span></a>    <span class="n">cls_attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_clsattr_with_settable_flag</span><span class="p">()</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><a href="#__codelineno-0-460"><span class="linenos" data-linenos="460 "></span></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><a href="#__codelineno-0-461"><span class="linenos" data-linenos="461 "></span></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><a href="#__codelineno-0-462"><span class="linenos" data-linenos="462 "></span></a>        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">` could never be deleted.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><a href="#__codelineno-0-463"><span class="linenos" data-linenos="463 "></span></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><a href="#__codelineno-0-464"><span class="linenos" data-linenos="464 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><a href="#__codelineno-0-465"><span class="linenos" data-linenos="465 "></span></a>        <span class="c1"># delete the property with same name defined in Meter from origin model</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><a href="#__codelineno-0-466"><span class="linenos" data-linenos="466 "></span></a>        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ORIGIN_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><a href="#__codelineno-0-467"><span class="linenos" data-linenos="467 "></span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><a href="#__codelineno-0-468"><span class="linenos" data-linenos="468 "></span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><a href="#__codelineno-0-469"><span class="linenos" data-linenos="469 "></span></a>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><a href="#__codelineno-0-470"><span class="linenos" data-linenos="470 "></span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__delattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><a href="#__codelineno-0-471"><span class="linenos" data-linenos="471 "></span></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><a href="#__codelineno-0-472"><span class="linenos" data-linenos="472 "></span></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><a href="#__codelineno-0-473"><span class="linenos" data-linenos="473 "></span></a>        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__device_detect" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__device_detect</span>


<a href="#torchmeter.core.Meter.__device_detect" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__device_detect</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tc_device</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Detects the device where the model are located via model's parameters.</p>
<p>This method detects the model's device by checking its parameters' location.
If no parameters are found, it will raise a warning and move the model to CPU by default.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model whose device is to be detected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.device">device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[str, torch.device]: The device where the model's parameters are located. If no parameters are found,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.device">device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>returns 'cpu' as the default device.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="UserWarning">UserWarning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the model has no parameters, a warning is issued indicating that the model will be moved
         to CPU for subsequent analysis.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1845" name="__codelineno-0-1845"></a><a href="#__codelineno-0-1845"><span class="linenos" data-linenos="1845 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">__device_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tc_device</span><span class="p">]:</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><a href="#__codelineno-0-1846"><span class="linenos" data-linenos="1846 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Detects the device where the model are located via model&#39;s parameters.</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a><a href="#__codelineno-0-1847"><span class="linenos" data-linenos="1847 "></span></a>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><a href="#__codelineno-0-1848"><span class="linenos" data-linenos="1848 "></span></a><span class="sd">    This method detects the model&#39;s device by checking its parameters&#39; location.</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><a href="#__codelineno-0-1849"><span class="linenos" data-linenos="1849 "></span></a><span class="sd">    If no parameters are found, it will raise a warning and move the model to CPU by default.</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a><a href="#__codelineno-0-1850"><span class="linenos" data-linenos="1850 "></span></a>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a><a href="#__codelineno-0-1851"><span class="linenos" data-linenos="1851 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a><a href="#__codelineno-0-1852"><span class="linenos" data-linenos="1852 "></span></a><span class="sd">        model (nn.Module): The model whose device is to be detected.</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a><a href="#__codelineno-0-1853"><span class="linenos" data-linenos="1853 "></span></a>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a><a href="#__codelineno-0-1854"><span class="linenos" data-linenos="1854 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a><a href="#__codelineno-0-1855"><span class="linenos" data-linenos="1855 "></span></a><span class="sd">        Union[str, torch.device]: The device where the model&#39;s parameters are located. If no parameters are found,</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a><a href="#__codelineno-0-1856"><span class="linenos" data-linenos="1856 "></span></a><span class="sd">        returns &#39;cpu&#39; as the default device.</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><a href="#__codelineno-0-1857"><span class="linenos" data-linenos="1857 "></span></a>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a><a href="#__codelineno-0-1858"><span class="linenos" data-linenos="1858 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a><a href="#__codelineno-0-1859"><span class="linenos" data-linenos="1859 "></span></a><span class="sd">        UserWarning: If the model has no parameters, a warning is issued indicating that the model will be moved</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a><a href="#__codelineno-0-1860"><span class="linenos" data-linenos="1860 "></span></a><span class="sd">                     to CPU for subsequent analysis.</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><a href="#__codelineno-0-1861"><span class="linenos" data-linenos="1861 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a><a href="#__codelineno-0-1862"><span class="linenos" data-linenos="1862 "></span></a>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a><a href="#__codelineno-0-1863"><span class="linenos" data-linenos="1863 "></span></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a><a href="#__codelineno-0-1864"><span class="linenos" data-linenos="1864 "></span></a>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a><a href="#__codelineno-0-1865"><span class="linenos" data-linenos="1865 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a><a href="#__codelineno-0-1866"><span class="linenos" data-linenos="1866 "></span></a>        <span class="n">model_first_param</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a><a href="#__codelineno-0-1867"><span class="linenos" data-linenos="1867 "></span></a>        <span class="k">return</span> <span class="n">model_first_param</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a><a href="#__codelineno-0-1868"><span class="linenos" data-linenos="1868 "></span></a>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a><a href="#__codelineno-0-1869"><span class="linenos" data-linenos="1869 "></span></a>    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><a href="#__codelineno-0-1870"><span class="linenos" data-linenos="1870 "></span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><a href="#__codelineno-0-1871"><span class="linenos" data-linenos="1871 "></span></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><a href="#__codelineno-0-1872"><span class="linenos" data-linenos="1872 "></span></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;We can&#39;t detect the device where your model is located because no parameter was found &quot;</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><a href="#__codelineno-0-1873"><span class="linenos" data-linenos="1873 "></span></a>            <span class="o">+</span> <span class="s2">&quot;in your model. We&#39;ll move your model to CPU and do all subsequent analysis based on this CPU &quot;</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><a href="#__codelineno-0-1874"><span class="linenos" data-linenos="1874 "></span></a>            <span class="o">+</span> <span class="s2">&quot;version. If this isn&#39;t what you want, change the device with `to` method, &quot;</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><a href="#__codelineno-0-1875"><span class="linenos" data-linenos="1875 "></span></a>            <span class="o">+</span> <span class="s2">&quot;e.g. `metered_model.to(&#39;cuda&#39;)`.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a><a href="#__codelineno-0-1876"><span class="linenos" data-linenos="1876 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><a href="#__codelineno-0-1877"><span class="linenos" data-linenos="1877 "></span></a>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><a href="#__codelineno-0-1878"><span class="linenos" data-linenos="1878 "></span></a>        <span class="k">return</span> <span class="s2">&quot;cpu&quot;</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__get_clsattr_with_settable_flag" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__get_clsattr_with_settable_flag</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#torchmeter.core.Meter.__get_clsattr_with_settable_flag" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__get_clsattr_with_settable_flag</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Determines which class attributes have setter methods defined.</p>
<p>This method iterates over all properties of the class and checks if a setter method
is defined for each property. It returns a dictionary mapping attribute names to a
boolean indicating whether the attribute is settable.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, bool]: A dictionary where keys are attribute names and values indicate</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether the attribute has a setter method (True if settable, False otherwise).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1946" name="__codelineno-0-1946"></a><a href="#__codelineno-0-1946"><span class="linenos" data-linenos="1946 "></span></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a><a href="#__codelineno-0-1947"><span class="linenos" data-linenos="1947 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">__get_clsattr_with_settable_flag</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a><a href="#__codelineno-0-1948"><span class="linenos" data-linenos="1948 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines which class attributes have setter methods defined.</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a><a href="#__codelineno-0-1949"><span class="linenos" data-linenos="1949 "></span></a>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a><a href="#__codelineno-0-1950"><span class="linenos" data-linenos="1950 "></span></a><span class="sd">    This method iterates over all properties of the class and checks if a setter method</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a><a href="#__codelineno-0-1951"><span class="linenos" data-linenos="1951 "></span></a><span class="sd">    is defined for each property. It returns a dictionary mapping attribute names to a</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a><a href="#__codelineno-0-1952"><span class="linenos" data-linenos="1952 "></span></a><span class="sd">    boolean indicating whether the attribute is settable.</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a><a href="#__codelineno-0-1953"><span class="linenos" data-linenos="1953 "></span></a>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a><a href="#__codelineno-0-1954"><span class="linenos" data-linenos="1954 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a><a href="#__codelineno-0-1955"><span class="linenos" data-linenos="1955 "></span></a><span class="sd">        Dict[str, bool]: A dictionary where keys are attribute names and values indicate</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a><a href="#__codelineno-0-1956"><span class="linenos" data-linenos="1956 "></span></a><span class="sd">        whether the attribute has a setter method (True if settable, False otherwise).</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><a href="#__codelineno-0-1957"><span class="linenos" data-linenos="1957 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a><a href="#__codelineno-0-1958"><span class="linenos" data-linenos="1958 "></span></a>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a><a href="#__codelineno-0-1959"><span class="linenos" data-linenos="1959 "></span></a>    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">fset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a><a href="#__codelineno-0-1960"><span class="linenos" data-linenos="1960 "></span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">property</span><span class="p">)}</span>  <span class="c1"># fmt: skip</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__getattr__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__getattr__</span>


<a href="#torchmeter.core.Meter.__getattr__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="fm">__getattr__</span><span class="p">(</span><span class="nf">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Transparently proxy attribute access to the underlying model when not found in Meter instance</p>
<p>This method enables seamless attribute access to the wrapped model while maintaining Meter's
own attributes. It follows these resolution rules:</p>
<ol>
<li>Directly returns Meter's own attributes if they exist</li>
<li>For attributes prefixed with "ORIGIN_", returns the underlying model's attribute with the prefix removed</li>
<li>Otherwise, returns the corresponding attribute from the wrapped model</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the attribute to retrieve</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value of the requested attribute from either Meter instance or underlying model</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>When the attribute does not exist in both Meter instance and underlying model</li>
<li>When using "ORIGIN_" prefix with non-existent attribute in underlying model</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>Attribute resolution priority:
    Meter's own attributes &gt; underlying model's attributes (unless "ORIGIN_" prefix is used)</p>
</li>
<li>
<p>To bypass Meter's attributes and directly access model's attributes with same name:
    Use "ORIGIN_" prefix (e.g., <code>meter.ORIGIN_param</code> maps to <code>model.param</code>)</p>
</li>
<li>
<p>This implementation ensures the Meter instance can be seamlessly used as a drop-in replacement
  for the underlying model without requiring code modifications</p>
</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-334" name="__codelineno-0-334"></a><a href="#__codelineno-0-334"><span class="linenos" data-linenos="334 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><a href="#__codelineno-0-335"><span class="linenos" data-linenos="335 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Transparently proxy attribute access to the underlying model when not found in Meter instance</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><a href="#__codelineno-0-336"><span class="linenos" data-linenos="336 "></span></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><a href="#__codelineno-0-337"><span class="linenos" data-linenos="337 "></span></a><span class="sd">    This method enables seamless attribute access to the wrapped model while maintaining Meter&#39;s</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><a href="#__codelineno-0-338"><span class="linenos" data-linenos="338 "></span></a><span class="sd">    own attributes. It follows these resolution rules:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><a href="#__codelineno-0-339"><span class="linenos" data-linenos="339 "></span></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><a href="#__codelineno-0-340"><span class="linenos" data-linenos="340 "></span></a><span class="sd">    1. Directly returns Meter&#39;s own attributes if they exist</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><a href="#__codelineno-0-341"><span class="linenos" data-linenos="341 "></span></a><span class="sd">    2. For attributes prefixed with &quot;ORIGIN_&quot;, returns the underlying model&#39;s attribute with the prefix removed</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><a href="#__codelineno-0-342"><span class="linenos" data-linenos="342 "></span></a><span class="sd">    3. Otherwise, returns the corresponding attribute from the wrapped model</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><a href="#__codelineno-0-343"><span class="linenos" data-linenos="343 "></span></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><a href="#__codelineno-0-344"><span class="linenos" data-linenos="344 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><a href="#__codelineno-0-345"><span class="linenos" data-linenos="345 "></span></a><span class="sd">        name (str): Name of the attribute to retrieve</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><a href="#__codelineno-0-346"><span class="linenos" data-linenos="346 "></span></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><a href="#__codelineno-0-347"><span class="linenos" data-linenos="347 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><a href="#__codelineno-0-348"><span class="linenos" data-linenos="348 "></span></a><span class="sd">        Any: The value of the requested attribute from either Meter instance or underlying model</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><a href="#__codelineno-0-349"><span class="linenos" data-linenos="349 "></span></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><a href="#__codelineno-0-350"><span class="linenos" data-linenos="350 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><a href="#__codelineno-0-351"><span class="linenos" data-linenos="351 "></span></a><span class="sd">        AttributeError:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><a href="#__codelineno-0-352"><span class="linenos" data-linenos="352 "></span></a><span class="sd">            - When the attribute does not exist in both Meter instance and underlying model</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><a href="#__codelineno-0-353"><span class="linenos" data-linenos="353 "></span></a><span class="sd">            - When using &quot;ORIGIN_&quot; prefix with non-existent attribute in underlying model</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><a href="#__codelineno-0-354"><span class="linenos" data-linenos="354 "></span></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><a href="#__codelineno-0-355"><span class="linenos" data-linenos="355 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><a href="#__codelineno-0-356"><span class="linenos" data-linenos="356 "></span></a><span class="sd">        - Attribute resolution priority:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><a href="#__codelineno-0-357"><span class="linenos" data-linenos="357 "></span></a><span class="sd">            Meter&#39;s own attributes &gt; underlying model&#39;s attributes (unless &quot;ORIGIN_&quot; prefix is used)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><a href="#__codelineno-0-358"><span class="linenos" data-linenos="358 "></span></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><a href="#__codelineno-0-359"><span class="linenos" data-linenos="359 "></span></a><span class="sd">        - To bypass Meter&#39;s attributes and directly access model&#39;s attributes with same name:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><a href="#__codelineno-0-360"><span class="linenos" data-linenos="360 "></span></a><span class="sd">            Use &quot;ORIGIN_&quot; prefix (e.g., `meter.ORIGIN_param` maps to `model.param`)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><a href="#__codelineno-0-361"><span class="linenos" data-linenos="361 "></span></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><a href="#__codelineno-0-362"><span class="linenos" data-linenos="362 "></span></a><span class="sd">        - This implementation ensures the Meter instance can be seamlessly used as a drop-in replacement</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><a href="#__codelineno-0-363"><span class="linenos" data-linenos="363 "></span></a><span class="sd">          for the underlying model without requiring code modifications</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><a href="#__codelineno-0-364"><span class="linenos" data-linenos="364 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><a href="#__codelineno-0-365"><span class="linenos" data-linenos="365 "></span></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><a href="#__codelineno-0-366"><span class="linenos" data-linenos="366 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><a href="#__codelineno-0-367"><span class="linenos" data-linenos="367 "></span></a>        <span class="c1"># get the property with same name defined in Meter from origin model</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><a href="#__codelineno-0-368"><span class="linenos" data-linenos="368 "></span></a>        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ORIGIN_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><a href="#__codelineno-0-369"><span class="linenos" data-linenos="369 "></span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><a href="#__codelineno-0-370"><span class="linenos" data-linenos="370 "></span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><a href="#__codelineno-0-371"><span class="linenos" data-linenos="371 "></span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><a href="#__codelineno-0-372"><span class="linenos" data-linenos="372 "></span></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><a href="#__codelineno-0-373"><span class="linenos" data-linenos="373 "></span></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><a href="#__codelineno-0-374"><span class="linenos" data-linenos="374 "></span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__is_ipt_changed" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__is_ipt_changed</span>


<a href="#torchmeter.core.Meter.__is_ipt_changed" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__is_ipt_changed</span><span class="p">(</span><span class="n">new_ipt</span><span class="p">:</span> <span class="n">IPT_TYPE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Determines if the new input differs from the current captured input.</p>
<p>Compares both positional arguments (args) and keyword arguments (kwargs) between current and new input:</p>
<ul>
<li>For Tensor arguments: Checks shape and dtype equivalence</li>
<li>For non-Tensor arguments: Performs value equality check</li>
<li>Verifies argument structure consistency (same length for args, same keys for kwargs)</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>new_ipt</code>
            </td>
            <td>
                  <code><span title="torchmeter.core.IPT_TYPE">IPT_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New input arguments to compare against currently stored input.
     It is a dictionary with two keys:
        - <code>args</code>: A tuple containing all positional arguments.
        - <code>kwargs</code>: A dictionary containing all keyword arguments.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if any of following conditions met:</p>
<ol>
<li>Current input is empty (first-time input)</li>
<li>Positional arguments differ in length/value type/shape (for Tensors)</li>
<li>Keyword arguments have different keys or values</li>
<li>Any argument value differs (non-Tensor) or tensor properties differ (Tensor)</li>
</ol>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><a href="#__codelineno-0-1880"><span class="linenos" data-linenos="1880 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">__is_ipt_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_ipt</span><span class="p">:</span> <span class="n">IPT_TYPE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># noqa: C901</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><a href="#__codelineno-0-1881"><span class="linenos" data-linenos="1881 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines if the new input differs from the current captured input.</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><a href="#__codelineno-0-1882"><span class="linenos" data-linenos="1882 "></span></a>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><a href="#__codelineno-0-1883"><span class="linenos" data-linenos="1883 "></span></a><span class="sd">    Compares both positional arguments (args) and keyword arguments (kwargs) between current and new input:</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><a href="#__codelineno-0-1884"><span class="linenos" data-linenos="1884 "></span></a>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><a href="#__codelineno-0-1885"><span class="linenos" data-linenos="1885 "></span></a><span class="sd">    - For Tensor arguments: Checks shape and dtype equivalence</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><a href="#__codelineno-0-1886"><span class="linenos" data-linenos="1886 "></span></a><span class="sd">    - For non-Tensor arguments: Performs value equality check</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><a href="#__codelineno-0-1887"><span class="linenos" data-linenos="1887 "></span></a><span class="sd">    - Verifies argument structure consistency (same length for args, same keys for kwargs)</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><a href="#__codelineno-0-1888"><span class="linenos" data-linenos="1888 "></span></a>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><a href="#__codelineno-0-1889"><span class="linenos" data-linenos="1889 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><a href="#__codelineno-0-1890"><span class="linenos" data-linenos="1890 "></span></a><span class="sd">        new_ipt: New input arguments to compare against currently stored input.</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><a href="#__codelineno-0-1891"><span class="linenos" data-linenos="1891 "></span></a><span class="sd">                 It is a dictionary with two keys:</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><a href="#__codelineno-0-1892"><span class="linenos" data-linenos="1892 "></span></a><span class="sd">                    - `args`: A tuple containing all positional arguments.</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><a href="#__codelineno-0-1893"><span class="linenos" data-linenos="1893 "></span></a><span class="sd">                    - `kwargs`: A dictionary containing all keyword arguments.</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><a href="#__codelineno-0-1894"><span class="linenos" data-linenos="1894 "></span></a>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><a href="#__codelineno-0-1895"><span class="linenos" data-linenos="1895 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><a href="#__codelineno-0-1896"><span class="linenos" data-linenos="1896 "></span></a><span class="sd">        bool: `True` if any of following conditions met:</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><a href="#__codelineno-0-1897"><span class="linenos" data-linenos="1897 "></span></a>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><a href="#__codelineno-0-1898"><span class="linenos" data-linenos="1898 "></span></a><span class="sd">            1. Current input is empty (first-time input)</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><a href="#__codelineno-0-1899"><span class="linenos" data-linenos="1899 "></span></a><span class="sd">            2. Positional arguments differ in length/value type/shape (for Tensors)</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><a href="#__codelineno-0-1900"><span class="linenos" data-linenos="1900 "></span></a><span class="sd">            3. Keyword arguments have different keys or values</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><a href="#__codelineno-0-1901"><span class="linenos" data-linenos="1901 "></span></a><span class="sd">            4. Any argument value differs (non-Tensor) or tensor properties differ (Tensor)</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><a href="#__codelineno-0-1902"><span class="linenos" data-linenos="1902 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><a href="#__codelineno-0-1903"><span class="linenos" data-linenos="1903 "></span></a>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><a href="#__codelineno-0-1904"><span class="linenos" data-linenos="1904 "></span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ipt_empty</span><span class="p">():</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a><a href="#__codelineno-0-1905"><span class="linenos" data-linenos="1905 "></span></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><a href="#__codelineno-0-1906"><span class="linenos" data-linenos="1906 "></span></a>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><a href="#__codelineno-0-1907"><span class="linenos" data-linenos="1907 "></span></a>    <span class="n">is_changed</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a><a href="#__codelineno-0-1908"><span class="linenos" data-linenos="1908 "></span></a>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><a href="#__codelineno-0-1909"><span class="linenos" data-linenos="1909 "></span></a>    <span class="c1"># check anonymous arguments</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><a href="#__codelineno-0-1910"><span class="linenos" data-linenos="1910 "></span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_ipt</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><a href="#__codelineno-0-1911"><span class="linenos" data-linenos="1911 "></span></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><a href="#__codelineno-0-1912"><span class="linenos" data-linenos="1912 "></span></a>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><a href="#__codelineno-0-1913"><span class="linenos" data-linenos="1913 "></span></a>    <span class="k">for</span> <span class="n">origin</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">],</span> <span class="n">new_ipt</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><a href="#__codelineno-0-1914"><span class="linenos" data-linenos="1914 "></span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">):</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><a href="#__codelineno-0-1915"><span class="linenos" data-linenos="1915 "></span></a>            <span class="n">is_changed</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><a href="#__codelineno-0-1916"><span class="linenos" data-linenos="1916 "></span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><a href="#__codelineno-0-1917"><span class="linenos" data-linenos="1917 "></span></a>            <span class="n">is_changed</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">new</span><span class="o">.</span><span class="n">shape</span> <span class="ow">or</span> <span class="n">origin</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">new</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><a href="#__codelineno-0-1918"><span class="linenos" data-linenos="1918 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><a href="#__codelineno-0-1919"><span class="linenos" data-linenos="1919 "></span></a>            <span class="n">is_changed</span> <span class="o">=</span> <span class="n">origin</span> <span class="o">!=</span> <span class="n">new</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a><a href="#__codelineno-0-1920"><span class="linenos" data-linenos="1920 "></span></a>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><a href="#__codelineno-0-1921"><span class="linenos" data-linenos="1921 "></span></a>        <span class="k">if</span> <span class="n">is_changed</span><span class="p">:</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><a href="#__codelineno-0-1922"><span class="linenos" data-linenos="1922 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><a href="#__codelineno-0-1923"><span class="linenos" data-linenos="1923 "></span></a>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><a href="#__codelineno-0-1924"><span class="linenos" data-linenos="1924 "></span></a>    <span class="c1"># check named arguments</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><a href="#__codelineno-0-1925"><span class="linenos" data-linenos="1925 "></span></a>    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_ipt</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><a href="#__codelineno-0-1926"><span class="linenos" data-linenos="1926 "></span></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><a href="#__codelineno-0-1927"><span class="linenos" data-linenos="1927 "></span></a>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><a href="#__codelineno-0-1928"><span class="linenos" data-linenos="1928 "></span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">origin</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ipt</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><a href="#__codelineno-0-1929"><span class="linenos" data-linenos="1929 "></span></a>        <span class="n">new</span> <span class="o">=</span> <span class="n">new_ipt</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><a href="#__codelineno-0-1930"><span class="linenos" data-linenos="1930 "></span></a>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><a href="#__codelineno-0-1931"><span class="linenos" data-linenos="1931 "></span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">):</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><a href="#__codelineno-0-1932"><span class="linenos" data-linenos="1932 "></span></a>            <span class="n">is_changed</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a><a href="#__codelineno-0-1933"><span class="linenos" data-linenos="1933 "></span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><a href="#__codelineno-0-1934"><span class="linenos" data-linenos="1934 "></span></a>            <span class="n">is_changed</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">new</span><span class="o">.</span><span class="n">shape</span> <span class="ow">or</span> <span class="n">origin</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">new</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><a href="#__codelineno-0-1935"><span class="linenos" data-linenos="1935 "></span></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><a href="#__codelineno-0-1936"><span class="linenos" data-linenos="1936 "></span></a>            <span class="n">is_changed</span> <span class="o">=</span> <span class="n">origin</span> <span class="o">!=</span> <span class="n">new</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><a href="#__codelineno-0-1937"><span class="linenos" data-linenos="1937 "></span></a>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a><a href="#__codelineno-0-1938"><span class="linenos" data-linenos="1938 "></span></a>        <span class="k">if</span> <span class="n">is_changed</span><span class="p">:</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a><a href="#__codelineno-0-1939"><span class="linenos" data-linenos="1939 "></span></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a><a href="#__codelineno-0-1940"><span class="linenos" data-linenos="1940 "></span></a>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a><a href="#__codelineno-0-1941"><span class="linenos" data-linenos="1941 "></span></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.__setattr__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__setattr__</span>


<a href="#torchmeter.core.Meter.__setattr__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="fm">__setattr__</span><span class="p">(</span><span class="nf">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prioritize setting attributes on Meter instance first, falling back to the underlying model.</p>
<p>This method ensures:
1. Class attributes defined in <code>Meter</code> that cannot be modified are blocked
2. Instance attributes are set first, falling back to model attributes if not present
3. Attributes prefixed with "ORIGIN_" will set the underlying model attribute after removing prefix</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the attribute to assign</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to be assigned to the attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>When attempting to set non-modifiable Meter class attributes.</li>
<li>When attribute assignment fails for both <code>Meter</code> instance and the underlying model</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>When encountering conflicting attribute names between Meter instance and the model:
    The Meter instance's attribute will be prioritized for assignment by default.
    To assign the underlying model's attribute with same name, prepend "ORIGIN_" prefix.
    Example: <code>meter_instance.ORIGIN_param = 1</code> will set model's <code>param</code> attribute to 1</p>
</li>
<li>
<p>This implementation ensures the Meter instance can be seamlessly used as a drop-in replacement
  for the underlying model without requiring code modifications</p>
</li>
<li>
<p>Non-modifiable Meter class attributes are attributes defined by <code>@property</code> but without a setter.
  include:</p>
<ol>
<li><code>ipt</code></li>
<li><code>structure</code></li>
<li><code>param</code></li>
<li><code>cal</code></li>
<li><code>mem</code></li>
<li><code>ittp</code></li>
<li><code>model_info</code></li>
<li><code>subnodes</code></li>
</ol>
</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-376" name="__codelineno-0-376"></a><a href="#__codelineno-0-376"><span class="linenos" data-linenos="376 "></span></a><span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><a href="#__codelineno-0-377"><span class="linenos" data-linenos="377 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prioritize setting attributes on Meter instance first, falling back to the underlying model.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><a href="#__codelineno-0-378"><span class="linenos" data-linenos="378 "></span></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><a href="#__codelineno-0-379"><span class="linenos" data-linenos="379 "></span></a><span class="sd">    This method ensures:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><a href="#__codelineno-0-380"><span class="linenos" data-linenos="380 "></span></a><span class="sd">    1. Class attributes defined in `Meter` that cannot be modified are blocked</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><a href="#__codelineno-0-381"><span class="linenos" data-linenos="381 "></span></a><span class="sd">    2. Instance attributes are set first, falling back to model attributes if not present</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><a href="#__codelineno-0-382"><span class="linenos" data-linenos="382 "></span></a><span class="sd">    3. Attributes prefixed with &quot;ORIGIN_&quot; will set the underlying model attribute after removing prefix</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><a href="#__codelineno-0-383"><span class="linenos" data-linenos="383 "></span></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><a href="#__codelineno-0-384"><span class="linenos" data-linenos="384 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><a href="#__codelineno-0-385"><span class="linenos" data-linenos="385 "></span></a><span class="sd">        name (str): Name of the attribute to assign</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><a href="#__codelineno-0-386"><span class="linenos" data-linenos="386 "></span></a><span class="sd">        value (Any): Value to be assigned to the attribute</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><a href="#__codelineno-0-387"><span class="linenos" data-linenos="387 "></span></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><a href="#__codelineno-0-388"><span class="linenos" data-linenos="388 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><a href="#__codelineno-0-389"><span class="linenos" data-linenos="389 "></span></a><span class="sd">        AttributeError:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><a href="#__codelineno-0-390"><span class="linenos" data-linenos="390 "></span></a><span class="sd">            - When attempting to set non-modifiable Meter class attributes.</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><a href="#__codelineno-0-391"><span class="linenos" data-linenos="391 "></span></a><span class="sd">            - When attribute assignment fails for both `Meter` instance and the underlying model</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><a href="#__codelineno-0-392"><span class="linenos" data-linenos="392 "></span></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><a href="#__codelineno-0-393"><span class="linenos" data-linenos="393 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><a href="#__codelineno-0-394"><span class="linenos" data-linenos="394 "></span></a><span class="sd">        - When encountering conflicting attribute names between Meter instance and the model:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><a href="#__codelineno-0-395"><span class="linenos" data-linenos="395 "></span></a><span class="sd">            The Meter instance&#39;s attribute will be prioritized for assignment by default.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><a href="#__codelineno-0-396"><span class="linenos" data-linenos="396 "></span></a><span class="sd">            To assign the underlying model&#39;s attribute with same name, prepend &quot;ORIGIN_&quot; prefix.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><a href="#__codelineno-0-397"><span class="linenos" data-linenos="397 "></span></a><span class="sd">            Example: `meter_instance.ORIGIN_param = 1` will set model&#39;s `param` attribute to 1</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><a href="#__codelineno-0-398"><span class="linenos" data-linenos="398 "></span></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><a href="#__codelineno-0-399"><span class="linenos" data-linenos="399 "></span></a><span class="sd">        - This implementation ensures the Meter instance can be seamlessly used as a drop-in replacement</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><a href="#__codelineno-0-400"><span class="linenos" data-linenos="400 "></span></a><span class="sd">          for the underlying model without requiring code modifications</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><a href="#__codelineno-0-401"><span class="linenos" data-linenos="401 "></span></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><a href="#__codelineno-0-402"><span class="linenos" data-linenos="402 "></span></a><span class="sd">        - Non-modifiable Meter class attributes are attributes defined by `@property` but without a setter.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><a href="#__codelineno-0-403"><span class="linenos" data-linenos="403 "></span></a><span class="sd">          include:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><a href="#__codelineno-0-404"><span class="linenos" data-linenos="404 "></span></a><span class="sd">            1. `ipt`</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><a href="#__codelineno-0-405"><span class="linenos" data-linenos="405 "></span></a><span class="sd">            2. `structure`</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><a href="#__codelineno-0-406"><span class="linenos" data-linenos="406 "></span></a><span class="sd">            3. `param`</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><a href="#__codelineno-0-407"><span class="linenos" data-linenos="407 "></span></a><span class="sd">            4. `cal`</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><a href="#__codelineno-0-408"><span class="linenos" data-linenos="408 "></span></a><span class="sd">            5. `mem`</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><a href="#__codelineno-0-409"><span class="linenos" data-linenos="409 "></span></a><span class="sd">            6. `ittp`</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><a href="#__codelineno-0-410"><span class="linenos" data-linenos="410 "></span></a><span class="sd">            7. `model_info`</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><a href="#__codelineno-0-411"><span class="linenos" data-linenos="411 "></span></a><span class="sd">            8. `subnodes`</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><a href="#__codelineno-0-412"><span class="linenos" data-linenos="412 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><a href="#__codelineno-0-413"><span class="linenos" data-linenos="413 "></span></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><a href="#__codelineno-0-414"><span class="linenos" data-linenos="414 "></span></a>    <span class="n">cls_attrs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_clsattr_with_settable_flag</span><span class="p">()</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><a href="#__codelineno-0-415"><span class="linenos" data-linenos="415 "></span></a>    <span class="n">notchange_cls_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">]</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><a href="#__codelineno-0-416"><span class="linenos" data-linenos="416 "></span></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><a href="#__codelineno-0-417"><span class="linenos" data-linenos="417 "></span></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">notchange_cls_attrs</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><a href="#__codelineno-0-418"><span class="linenos" data-linenos="418 "></span></a>        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">` could never be set.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><a href="#__codelineno-0-419"><span class="linenos" data-linenos="419 "></span></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><a href="#__codelineno-0-420"><span class="linenos" data-linenos="420 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><a href="#__codelineno-0-421"><span class="linenos" data-linenos="421 "></span></a>        <span class="c1"># set the property with same name defined in Meter from origin model</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><a href="#__codelineno-0-422"><span class="linenos" data-linenos="422 "></span></a>        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ORIGIN_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><a href="#__codelineno-0-423"><span class="linenos" data-linenos="423 "></span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><a href="#__codelineno-0-424"><span class="linenos" data-linenos="424 "></span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><a href="#__codelineno-0-425"><span class="linenos" data-linenos="425 "></span></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><a href="#__codelineno-0-426"><span class="linenos" data-linenos="426 "></span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><a href="#__codelineno-0-427"><span class="linenos" data-linenos="427 "></span></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><a href="#__codelineno-0-428"><span class="linenos" data-linenos="428 "></span></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><a href="#__codelineno-0-429"><span class="linenos" data-linenos="429 "></span></a>        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.overview" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">overview</span>


<a href="#torchmeter.core.Meter.overview" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">overview</span><span class="p">(</span><span class="o">*</span><span class="n">order</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates an overview of all statistics in a formatted layout.</p>
<p>This method creates a visual overview of model statistics, including basic model
information and core data of each specified statistic. You can customize the statistics
contained in the rendering results and their order by passing in the statistics you want
in the order you prefer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*order</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names of the statistics to include in the overview. If not provided,
        all available statistics are included.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_warning</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display warnings for potentially inaccurate results.
                Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Columns</code></td>            <td>
                  <code><span title="rich.columns.Columns">Columns</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>rich.Columns</code> object containing the formatted overview.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the provided statistics names are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">randn</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">model</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1"># overview all statistics (i.e. param, cal, mem, ittp)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">overview</span><span class="p">()</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="c1"># only overview `cal` and `param`</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="c1"># and the order is `cal` then `param`</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">overview</span><span class="p">(</span><span class="s2">&quot;cal&quot;</span><span class="p">,</span> <span class="s2">&quot;param&quot;</span><span class="p">)</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><a href="#__codelineno-0-1375"><span class="linenos" data-linenos="1375 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">overview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">order</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><a href="#__codelineno-0-1376"><span class="linenos" data-linenos="1376 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates an overview of all statistics in a formatted layout.</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><a href="#__codelineno-0-1377"><span class="linenos" data-linenos="1377 "></span></a>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><a href="#__codelineno-0-1378"><span class="linenos" data-linenos="1378 "></span></a><span class="sd">    This method creates a visual overview of model statistics, including basic model</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><a href="#__codelineno-0-1379"><span class="linenos" data-linenos="1379 "></span></a><span class="sd">    information and core data of each specified statistic. You can customize the statistics</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><a href="#__codelineno-0-1380"><span class="linenos" data-linenos="1380 "></span></a><span class="sd">    contained in the rendering results and their order by passing in the statistics you want</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><a href="#__codelineno-0-1381"><span class="linenos" data-linenos="1381 "></span></a><span class="sd">    in the order you prefer.</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a><a href="#__codelineno-0-1382"><span class="linenos" data-linenos="1382 "></span></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><a href="#__codelineno-0-1383"><span class="linenos" data-linenos="1383 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><a href="#__codelineno-0-1384"><span class="linenos" data-linenos="1384 "></span></a><span class="sd">        *order (str): The names of the statistics to include in the overview. If not provided,</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><a href="#__codelineno-0-1385"><span class="linenos" data-linenos="1385 "></span></a><span class="sd">                    all available statistics are included.</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a><a href="#__codelineno-0-1386"><span class="linenos" data-linenos="1386 "></span></a><span class="sd">        show_warning (bool): Whether to display warnings for potentially inaccurate results.</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><a href="#__codelineno-0-1387"><span class="linenos" data-linenos="1387 "></span></a><span class="sd">                            Defaults to True.</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><a href="#__codelineno-0-1388"><span class="linenos" data-linenos="1388 "></span></a>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><a href="#__codelineno-0-1389"><span class="linenos" data-linenos="1389 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><a href="#__codelineno-0-1390"><span class="linenos" data-linenos="1390 "></span></a><span class="sd">        Columns: A `rich.Columns` object containing the formatted overview.</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><a href="#__codelineno-0-1391"><span class="linenos" data-linenos="1391 "></span></a>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><a href="#__codelineno-0-1392"><span class="linenos" data-linenos="1392 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><a href="#__codelineno-0-1393"><span class="linenos" data-linenos="1393 "></span></a><span class="sd">        ValueError: If any of the provided statistics names are invalid.</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><a href="#__codelineno-0-1394"><span class="linenos" data-linenos="1394 "></span></a>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><a href="#__codelineno-0-1395"><span class="linenos" data-linenos="1395 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><a href="#__codelineno-0-1396"><span class="linenos" data-linenos="1396 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><a href="#__codelineno-0-1397"><span class="linenos" data-linenos="1397 "></span></a><span class="sd">        from torch import randn</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><a href="#__codelineno-0-1398"><span class="linenos" data-linenos="1398 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a><a href="#__codelineno-0-1399"><span class="linenos" data-linenos="1399 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><a href="#__codelineno-0-1400"><span class="linenos" data-linenos="1400 "></span></a>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><a href="#__codelineno-0-1401"><span class="linenos" data-linenos="1401 "></span></a><span class="sd">        underlying_model = models.resnet18()</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><a href="#__codelineno-0-1402"><span class="linenos" data-linenos="1402 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a><a href="#__codelineno-0-1403"><span class="linenos" data-linenos="1403 "></span></a><span class="sd">        model(randn(1, 3, 224, 224))</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><a href="#__codelineno-0-1404"><span class="linenos" data-linenos="1404 "></span></a>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><a href="#__codelineno-0-1405"><span class="linenos" data-linenos="1405 "></span></a><span class="sd">        # overview all statistics (i.e. param, cal, mem, ittp)</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a><a href="#__codelineno-0-1406"><span class="linenos" data-linenos="1406 "></span></a><span class="sd">        model.overview()</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><a href="#__codelineno-0-1407"><span class="linenos" data-linenos="1407 "></span></a>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><a href="#__codelineno-0-1408"><span class="linenos" data-linenos="1408 "></span></a><span class="sd">        # only overview `cal` and `param`</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a><a href="#__codelineno-0-1409"><span class="linenos" data-linenos="1409 "></span></a><span class="sd">        # and the order is `cal` then `param`</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a><a href="#__codelineno-0-1410"><span class="linenos" data-linenos="1410 "></span></a><span class="sd">        model.overview(&quot;cal&quot;, &quot;param&quot;)</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><a href="#__codelineno-0-1411"><span class="linenos" data-linenos="1411 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><a href="#__codelineno-0-1412"><span class="linenos" data-linenos="1412 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><a href="#__codelineno-0-1413"><span class="linenos" data-linenos="1413 "></span></a>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a><a href="#__codelineno-0-1414"><span class="linenos" data-linenos="1414 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a><a href="#__codelineno-0-1415"><span class="linenos" data-linenos="1415 "></span></a>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a><a href="#__codelineno-0-1416"><span class="linenos" data-linenos="1416 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">rich.box</span><span class="w"> </span><span class="kn">import</span> <span class="n">HORIZONTALS</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a><a href="#__codelineno-0-1417"><span class="linenos" data-linenos="1417 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">rich.panel</span><span class="w"> </span><span class="kn">import</span> <span class="n">Panel</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a><a href="#__codelineno-0-1418"><span class="linenos" data-linenos="1418 "></span></a>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a><a href="#__codelineno-0-1419"><span class="linenos" data-linenos="1419 "></span></a>    <span class="n">order</span> <span class="o">=</span> <span class="n">order</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">statistics</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a><a href="#__codelineno-0-1420"><span class="linenos" data-linenos="1420 "></span></a>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><a href="#__codelineno-0-1421"><span class="linenos" data-linenos="1421 "></span></a>    <span class="n">invalid_stat</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">statistics</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><a href="#__codelineno-0-1422"><span class="linenos" data-linenos="1422 "></span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">invalid_stat</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><a href="#__codelineno-0-1423"><span class="linenos" data-linenos="1423 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid statistics: </span><span class="si">{</span><span class="n">invalid_stat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a><a href="#__codelineno-0-1424"><span class="linenos" data-linenos="1424 "></span></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><a href="#__codelineno-0-1425"><span class="linenos" data-linenos="1425 "></span></a>    <span class="n">container</span> <span class="o">=</span> <span class="n">Columns</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><a href="#__codelineno-0-1426"><span class="linenos" data-linenos="1426 "></span></a>    <span class="n">format_cell</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">Panel</span><span class="p">,</span> <span class="n">safe_box</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">HORIZONTALS</span><span class="p">)</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><a href="#__codelineno-0-1427"><span class="linenos" data-linenos="1427 "></span></a>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a><a href="#__codelineno-0-1428"><span class="linenos" data-linenos="1428 "></span></a>    <span class="n">container</span><span class="o">.</span><span class="n">add_renderable</span><span class="p">(</span><span class="n">format_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_info</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;[b]Model INFO[/]&quot;</span><span class="p">,</span> <span class="n">border_style</span><span class="o">=</span><span class="s2">&quot;orange1&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><a href="#__codelineno-0-1429"><span class="linenos" data-linenos="1429 "></span></a>    <span class="n">container</span><span class="o">.</span><span class="n">renderables</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><a href="#__codelineno-0-1430"><span class="linenos" data-linenos="1430 "></span></a>        <span class="n">format_cell</span><span class="p">(</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><a href="#__codelineno-0-1431"><span class="linenos" data-linenos="1431 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stat_info</span><span class="p">(</span><span class="n">stat_name</span><span class="p">,</span> <span class="n">show_warning</span><span class="o">=</span><span class="n">show_warning</span><span class="p">),</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a><a href="#__codelineno-0-1432"><span class="linenos" data-linenos="1432 "></span></a>            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[b]</span><span class="si">{</span><span class="n">stat_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> INFO[/]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><a href="#__codelineno-0-1433"><span class="linenos" data-linenos="1433 "></span></a>            <span class="n">border_style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><a href="#__codelineno-0-1434"><span class="linenos" data-linenos="1434 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a><a href="#__codelineno-0-1435"><span class="linenos" data-linenos="1435 "></span></a>        <span class="k">for</span> <span class="n">stat_name</span> <span class="ow">in</span> <span class="n">order</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a><a href="#__codelineno-0-1436"><span class="linenos" data-linenos="1436 "></span></a>    <span class="p">])</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><a href="#__codelineno-0-1437"><span class="linenos" data-linenos="1437 "></span></a>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><a href="#__codelineno-0-1438"><span class="linenos" data-linenos="1438 "></span></a>    <span class="k">return</span> <span class="n">container</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.profile" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">profile</span>


<a href="#torchmeter.core.Meter.profile" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">profile</span><span class="p">(</span><span class="n">stat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">no_tree</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">tb_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Render a tabular report of the specified statistics with rich visualization.</p>
<p>This method generates an interactive table visualization for the given statistical data,
optionally combined with the model's operation tree structure. The rendering supports
real-time customization through keyword arguments and can export data to multiple formats.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stat_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the statistics to profile (i.e., 'param', 'cal', 'mem', 'ittp').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to immediately render the visualization and display in terminal.
                   Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>no_tree</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not to display the rendered tree when set to True. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**tb_kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional table customization options:</p>
<ul>
<li>raw_data (<code>bool</code>): Use raw numerical data instead of formatted values with unit.
                     Defaults to <code>False</code>.</li>
<li>pick_cols (<code>Sequence[str]</code>): Whitelist of columns to display. Defaults to <code>[]</code>.</li>
<li>exclude_cols (<code>Sequence[str]</code>): Blacklist of columns to hide. Defaults to <code>[]</code>.</li>
<li>custom_cols (<code>Dict[str, str]</code>): Column rename mappings (original: new). Defaults to <code>{}</code>.</li>
<li>keep_custom_name (<code>bool</code>): Whether to keep custom names after this call. Defaults to <code>False</code>.</li>
<li>newcol_name (<code>str</code>): Name for new computed column. Defaults to <code>''</code>.</li>
<li>newcol_func (<code>Callable[[DataFrame], ArrayLike]</code>): Function to compute new column values.
                                                    Defaults to <code>lambda df: [None]*len(df)</code>.</li>
<li>newcol_type (<code>Optional[PolarsDataType]</code>): Explicit data type for new column. Defaults to <code>None</code>.</li>
<li>newcol_idx (<code>int</code>): Insertion position for new column (-1=append). Defaults to <code>-1</code>.</li>
<li>keep_new_col (<code>bool</code>): Retain new columns in backend dataframe and subsequent renders.
                         Defaults to <code>False</code>.</li>
<li>save_to (<code>Optional[str]</code>): File path for data export, not None to trigger export. Defaults to <code>None</code>.</li>
<li>save_format (<code>Optional[str]</code>): Export format, <code>None</code> to use the value in <code>save_to</code>.
                                 Now we only support <code>csv</code> or <code>xlsx</code> file. Defaults to <code>None</code>.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="rich.table.Table">Table</span>, <span title="polars.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rendered <code>rich.table.Table</code> object and underlying polars DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeWarning">RuntimeWarning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If your model has some modules defined but not explicitly called.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>stat_name</code> is not a valid statistics name.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If horizontal gap defined in global config is negative when disable <code>no_tree</code>.</li>
<li>If you specify any not existing column name to <code>pick_cols</code> when enable <code>show</code> and <code>pick_cols</code>.</li>
<li>If you pass in a directory path as <code>save_to</code> but not specify <code>save_format</code>.</li>
<li>If you pass in a non csv or xlsx file path as <code>save_to</code>.</li>
<li>If you pass in a non-supported export format as <code>save_format</code>.</li>
<li>If <code>newcol_name</code> already exists in the backend dataframe.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If terminal width is insufficient for display when enable <code>show</code>.</li>
<li>If no input data has been provided (i.e., <code>ipt</code> property is empty) and <code>stat_name</code> is
  one of <code>cal</code>, <code>mem</code>, or <code>ittp</code>.</li>
<li>If no module is called (e.g. the underlying model's <code>forward</code> method is not empty).</li>
<li>If the whole model is empty and has no sublayers.</li>
<li>If using a single layer as a model</li>
<li>If <code>newcol_func</code> returns values with length mismatch to the underlying dataframe's row count</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If <code>stat_name</code> is not a string</li>
<li>If <code>pick_cols</code> is not a list, tuple or set.</li>
<li>If <code>exclude_cols</code> is not a list, tuple or set.</li>
<li>If <code>custom_cols</code> is not a dict.</li>
<li>If <code>newcol_name</code> is not a string.</li>
<li>If <code>newcol_func</code> is uncallable</li>
<li>If <code>newcol_func</code> doesn't have exactly <strong>1</strong> formal parameter</li>
<li>If return value of <code>newcol_func</code> is not array-like</li>
<li>If <code>newcol_idx</code> is not an integer.</li>
<li>If <code>newcol_type</code> is not a valid Polars data type.</li>
<li>If <code>save_to</code> is not a string, neither None.</li>
<li>If <code>save_format</code> is not a string, neither None.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ol>
<li>
<p>Ensure at least one forward pass has been executed before accessing <code>cal</code>/<code>mem</code>/<code>ittp</code> statistics to
   guarantee valid input capture.</p>
</li>
<li>
<p>Table and tree rendering styles can be preconfigured through the properties:</p>
<ul>
<li><code>table_display_args</code></li>
<li><code>table_column_args</code></li>
<li><code>tree_fold_args</code></li>
<li><code>tree_levels_args</code></li>
<li><code>tree_repeat_block_args</code></li>
</ul>
</li>
<li>
<p>The rendering result will be progressively displayed line-by-line with a time interval.
   You can configure this interval through the following steps (must be non-negative):
    <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_config</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a><span class="n">cfg</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a><span class="n">cfg</span><span class="o">.</span><span class="n">render_interval</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># unit second, should be non-negative</span>
</code></pre></div></p>
</li>
<li>
<p>Disable rendering (<code>show=False</code>) when only exporting data to reduce computational overhead.</p>
</li>
<li>
<p>Enable <code>no_tree</code> to:</p>
<ul>
<li>Enable focused data analysis</li>
<li>Hide the operation tree for narrow terminals</li>
<li>Default layout shows tree left + table right (may enforce row separators if space constrained)</li>
</ul>
</li>
<li>
<p>Horizontal spacing between tree and table is controlled by <code>combine.horizon_gap</code> in global config.
   You should promise the value is non-negative.</p>
</li>
<li>
<p>When <code>raw_data=True</code> displays unformatted values:</p>
<ul>
<li><code>param</code>: Parameter counts</li>
<li><code>cal</code>: FLOPs/MACs counts</li>
<li><code>mem</code>: Bytes consumed</li>
<li><code>ittp</code>: Median inference time (seconds) and inferences per second per module</li>
</ul>
</li>
<li>
<p>Column management:</p>
<ul>
<li>Use <code>pick_cols</code> to reorder columns (validate column names via
  <code>metered_instance.table_cols(stat_name)</code>)</li>
<li>Processing order: <code>pick_cols</code> -&gt; <code>exclude_cols</code> -&gt; <code>custom_cols</code> -&gt; <code>newcol</code></li>
<li>Conflicts:<ul>
<li>picked columns override custom/newcol names</li>
<li>exclusions override picks</li>
</ul>
</li>
</ul>
</li>
<li>
<p>About <code>newcol_func</code>:</p>
<ul>
<li>must have exactly <strong>1</strong> formal parameter (name irrelevant) that will receive the
  underlying <code>polars.DataFrame</code> of specified statistics.</li>
<li>Implement logic using the incoming dataframe to return new column values (must be 1D array-like data
  such as <code>Series</code>, <code>lists</code>, <code>ndarrays</code>, etc.). Note that you can use <code>val</code> property to access the
  raw data for all statistics (for <code>ittp</code>, the return will be a tuple made up of the median and iqr of
  the measurement data sequence).</li>
<li>The example below demonstrates adding a percentage column of the <code>cal</code> statistics. Refer to
  <a href="https://docs.pola.rs/api/python/stable/reference/dataframe/index.html">https://docs.pola.rs/api/python/stable/reference/dataframe/index.html</a> for using <code>polars.Dataframe</code>.</li>
</ul>
</li>
<li>
<p>The <code>newcol_idx</code> parameter mostly follows Python list insertion semantics:</p>
<ul>
<li>Negative values count backward from end (<code>-1</code>=<code>append</code>)</li>
<li><code>0</code> inserts at beginning</li>
<li>Values exceeding column count clamp to nearest valid position:</li>
<li>Negative abs values &gt; column count â†’ insert at start</li>
<li>Positive values &gt; column count â†’ append at end</li>
</ul>
</li>
<li>
<p>Session persistence:</p>
<ul>
<li><code>keep_new_col</code> retains created columns</li>
<li><code>keep_custom_name</code> preserves renamed columns</li>
</ul>
</li>
<li>
<p>Export paths:</p>
<ul>
<li>Directory paths require explicit <code>save_format</code></li>
<li>File paths auto-detect format from extension unless <code>save_format</code> overrides</li>
</ul>
</li>
</ol>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="c1"># wrap your model with Meter</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">alexnet</span><span class="p">()</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1"># execute a forward inference (necessary, to provide input data)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="c1"># check column names of cal tabel</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table_cols</span><span class="p">(</span><span class="s2">&quot;cal&quot;</span><span class="p">))</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="c1"># (&#39;Operation_Id&#39;, &#39;Operation_Name&#39;, &#39;Operation_Type&#39;, &#39;Kernel_Size&#39;, &#39;Bias&#39;,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="c1"># &#39;Input&#39;, &#39;Output&#39;, &#39;MACs&#39;, &#39;FLOPs&#39;)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">newcol_logic</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a>    <span class="n">flops_col</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;FLOPs&quot;</span><span class="p">]</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a>    <span class="k">return</span> <span class="n">flops_col</span><span class="o">.</span><span class="n">map_elements</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">metered_model</span><span class="o">.</span><span class="n">cal</span><span class="o">.</span><span class="n">Flops</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a><span class="c1"># Customized profile with column operations</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos="25 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="s2">&quot;cal&quot;</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><a href="#__codelineno-0-27"><span class="linenos" data-linenos="27 "></span></a>    <span class="c1"># render and display immediately</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><a href="#__codelineno-0-28"><span class="linenos" data-linenos="28 "></span></a>    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><a href="#__codelineno-0-29"><span class="linenos" data-linenos="29 "></span></a>    <span class="n">no_tree</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><a href="#__codelineno-0-30"><span class="linenos" data-linenos="30 "></span></a>    <span class="n">raw_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><a href="#__codelineno-0-31"><span class="linenos" data-linenos="31 "></span></a>    <span class="c1"># columns management</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><a href="#__codelineno-0-32"><span class="linenos" data-linenos="32 "></span></a>    <span class="n">exclude_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Kernel_Size&quot;</span><span class="p">,</span> <span class="s2">&quot;Bias&quot;</span><span class="p">],</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><a href="#__codelineno-0-33"><span class="linenos" data-linenos="33 "></span></a>    <span class="n">custom_cols</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Operation_Id&quot;</span><span class="p">:</span> <span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation_Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Module Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation_Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Module Type&quot;</span><span class="p">},</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><a href="#__codelineno-0-34"><span class="linenos" data-linenos="34 "></span></a>    <span class="n">newcol_name</span><span class="o">=</span><span class="s2">&quot;Percentage&quot;</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><a href="#__codelineno-0-35"><span class="linenos" data-linenos="35 "></span></a>    <span class="n">newcol_func</span><span class="o">=</span><span class="n">newcol_logic</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><a href="#__codelineno-0-36"><span class="linenos" data-linenos="36 "></span></a>    <span class="n">newcol_type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><a href="#__codelineno-0-37"><span class="linenos" data-linenos="37 "></span></a>    <span class="n">newcol_idx</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><a href="#__codelineno-0-38"><span class="linenos" data-linenos="38 "></span></a>    <span class="c1"># export</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><a href="#__codelineno-0-39"><span class="linenos" data-linenos="39 "></span></a>    <span class="n">save_to</span><span class="o">=</span><span class="s2">&quot;./cal_profile.xlsx&quot;</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><a href="#__codelineno-0-40"><span class="linenos" data-linenos="40 "></span></a>    <span class="n">save_format</span><span class="o">=</span><span class="s2">&quot;xlsx&quot;</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><a href="#__codelineno-0-41"><span class="linenos" data-linenos="41 "></span></a><span class="p">)</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1518" name="__codelineno-0-1518"></a><a href="#__codelineno-0-1518"><span class="linenos" data-linenos="1518 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">no_tree</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">tb_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a><a href="#__codelineno-0-1519"><span class="linenos" data-linenos="1519 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Render a tabular report of the specified statistics with rich visualization.</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a><a href="#__codelineno-0-1520"><span class="linenos" data-linenos="1520 "></span></a>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a><a href="#__codelineno-0-1521"><span class="linenos" data-linenos="1521 "></span></a><span class="sd">    This method generates an interactive table visualization for the given statistical data,</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a><a href="#__codelineno-0-1522"><span class="linenos" data-linenos="1522 "></span></a><span class="sd">    optionally combined with the model&#39;s operation tree structure. The rendering supports</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a><a href="#__codelineno-0-1523"><span class="linenos" data-linenos="1523 "></span></a><span class="sd">    real-time customization through keyword arguments and can export data to multiple formats.</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a><a href="#__codelineno-0-1524"><span class="linenos" data-linenos="1524 "></span></a>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a><a href="#__codelineno-0-1525"><span class="linenos" data-linenos="1525 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><a href="#__codelineno-0-1526"><span class="linenos" data-linenos="1526 "></span></a><span class="sd">        stat_name (str): Name of the statistics to profile (i.e., &#39;param&#39;, &#39;cal&#39;, &#39;mem&#39;, &#39;ittp&#39;).</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><a href="#__codelineno-0-1527"><span class="linenos" data-linenos="1527 "></span></a>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a><a href="#__codelineno-0-1528"><span class="linenos" data-linenos="1528 "></span></a><span class="sd">        show (bool, optional): Whether to immediately render the visualization and display in terminal.</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><a href="#__codelineno-0-1529"><span class="linenos" data-linenos="1529 "></span></a><span class="sd">                               Defaults to True.</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a><a href="#__codelineno-0-1530"><span class="linenos" data-linenos="1530 "></span></a>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><a href="#__codelineno-0-1531"><span class="linenos" data-linenos="1531 "></span></a><span class="sd">        no_tree (bool, optional): Not to display the rendered tree when set to True. Defaults to False.</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><a href="#__codelineno-0-1532"><span class="linenos" data-linenos="1532 "></span></a>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><a href="#__codelineno-0-1533"><span class="linenos" data-linenos="1533 "></span></a><span class="sd">        **tb_kwargs: Additional table customization options:</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><a href="#__codelineno-0-1534"><span class="linenos" data-linenos="1534 "></span></a>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><a href="#__codelineno-0-1535"><span class="linenos" data-linenos="1535 "></span></a><span class="sd">            - raw_data (`bool`): Use raw numerical data instead of formatted values with unit.</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><a href="#__codelineno-0-1536"><span class="linenos" data-linenos="1536 "></span></a><span class="sd">                                 Defaults to `False`.</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><a href="#__codelineno-0-1537"><span class="linenos" data-linenos="1537 "></span></a><span class="sd">            - pick_cols (`Sequence[str]`): Whitelist of columns to display. Defaults to `[]`.</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><a href="#__codelineno-0-1538"><span class="linenos" data-linenos="1538 "></span></a><span class="sd">            - exclude_cols (`Sequence[str]`): Blacklist of columns to hide. Defaults to `[]`.</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><a href="#__codelineno-0-1539"><span class="linenos" data-linenos="1539 "></span></a><span class="sd">            - custom_cols (`Dict[str, str]`): Column rename mappings (original: new). Defaults to `{}`.</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><a href="#__codelineno-0-1540"><span class="linenos" data-linenos="1540 "></span></a><span class="sd">            - keep_custom_name (`bool`): Whether to keep custom names after this call. Defaults to `False`.</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><a href="#__codelineno-0-1541"><span class="linenos" data-linenos="1541 "></span></a><span class="sd">            - newcol_name (`str`): Name for new computed column. Defaults to `&#39;&#39;`.</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a><a href="#__codelineno-0-1542"><span class="linenos" data-linenos="1542 "></span></a><span class="sd">            - newcol_func (`Callable[[DataFrame], ArrayLike]`): Function to compute new column values.</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a><a href="#__codelineno-0-1543"><span class="linenos" data-linenos="1543 "></span></a><span class="sd">                                                                Defaults to `lambda df: [None]*len(df)`.</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><a href="#__codelineno-0-1544"><span class="linenos" data-linenos="1544 "></span></a><span class="sd">            - newcol_type (`Optional[PolarsDataType]`): Explicit data type for new column. Defaults to `None`.</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><a href="#__codelineno-0-1545"><span class="linenos" data-linenos="1545 "></span></a><span class="sd">            - newcol_idx (`int`): Insertion position for new column (-1=append). Defaults to `-1`.</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><a href="#__codelineno-0-1546"><span class="linenos" data-linenos="1546 "></span></a><span class="sd">            - keep_new_col (`bool`): Retain new columns in backend dataframe and subsequent renders.</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><a href="#__codelineno-0-1547"><span class="linenos" data-linenos="1547 "></span></a><span class="sd">                                     Defaults to `False`.</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><a href="#__codelineno-0-1548"><span class="linenos" data-linenos="1548 "></span></a><span class="sd">            - save_to (`Optional[str]`): File path for data export, not None to trigger export. Defaults to `None`.</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><a href="#__codelineno-0-1549"><span class="linenos" data-linenos="1549 "></span></a><span class="sd">            - save_format (`Optional[str]`): Export format, `None` to use the value in `save_to`.</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><a href="#__codelineno-0-1550"><span class="linenos" data-linenos="1550 "></span></a><span class="sd">                                             Now we only support `csv` or `xlsx` file. Defaults to `None`.</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><a href="#__codelineno-0-1551"><span class="linenos" data-linenos="1551 "></span></a>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><a href="#__codelineno-0-1552"><span class="linenos" data-linenos="1552 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><a href="#__codelineno-0-1553"><span class="linenos" data-linenos="1553 "></span></a><span class="sd">        The rendered `rich.table.Table` object and underlying polars DataFrame.</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><a href="#__codelineno-0-1554"><span class="linenos" data-linenos="1554 "></span></a>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><a href="#__codelineno-0-1555"><span class="linenos" data-linenos="1555 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><a href="#__codelineno-0-1556"><span class="linenos" data-linenos="1556 "></span></a><span class="sd">        RuntimeWarning: If your model has some modules defined but not explicitly called.</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><a href="#__codelineno-0-1557"><span class="linenos" data-linenos="1557 "></span></a>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><a href="#__codelineno-0-1558"><span class="linenos" data-linenos="1558 "></span></a><span class="sd">        AttributeError: If `stat_name` is not a valid statistics name.</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><a href="#__codelineno-0-1559"><span class="linenos" data-linenos="1559 "></span></a>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><a href="#__codelineno-0-1560"><span class="linenos" data-linenos="1560 "></span></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><a href="#__codelineno-0-1561"><span class="linenos" data-linenos="1561 "></span></a><span class="sd">            - If horizontal gap defined in global config is negative when disable `no_tree`.</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><a href="#__codelineno-0-1562"><span class="linenos" data-linenos="1562 "></span></a><span class="sd">            - If you specify any not existing column name to `pick_cols` when enable `show` and `pick_cols`.</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><a href="#__codelineno-0-1563"><span class="linenos" data-linenos="1563 "></span></a><span class="sd">            - If you pass in a directory path as `save_to` but not specify `save_format`.</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><a href="#__codelineno-0-1564"><span class="linenos" data-linenos="1564 "></span></a><span class="sd">            - If you pass in a non csv or xlsx file path as `save_to`.</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><a href="#__codelineno-0-1565"><span class="linenos" data-linenos="1565 "></span></a><span class="sd">            - If you pass in a non-supported export format as `save_format`.</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><a href="#__codelineno-0-1566"><span class="linenos" data-linenos="1566 "></span></a><span class="sd">            - If `newcol_name` already exists in the backend dataframe.</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><a href="#__codelineno-0-1567"><span class="linenos" data-linenos="1567 "></span></a>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><a href="#__codelineno-0-1568"><span class="linenos" data-linenos="1568 "></span></a><span class="sd">        RuntimeError:</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><a href="#__codelineno-0-1569"><span class="linenos" data-linenos="1569 "></span></a><span class="sd">            - If terminal width is insufficient for display when enable `show`.</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><a href="#__codelineno-0-1570"><span class="linenos" data-linenos="1570 "></span></a><span class="sd">            - If no input data has been provided (i.e., `ipt` property is empty) and `stat_name` is</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><a href="#__codelineno-0-1571"><span class="linenos" data-linenos="1571 "></span></a><span class="sd">              one of `cal`, `mem`, or `ittp`.</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><a href="#__codelineno-0-1572"><span class="linenos" data-linenos="1572 "></span></a><span class="sd">            - If no module is called (e.g. the underlying model&#39;s `forward` method is not empty).</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><a href="#__codelineno-0-1573"><span class="linenos" data-linenos="1573 "></span></a><span class="sd">            - If the whole model is empty and has no sublayers.</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><a href="#__codelineno-0-1574"><span class="linenos" data-linenos="1574 "></span></a><span class="sd">            - If using a single layer as a model</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><a href="#__codelineno-0-1575"><span class="linenos" data-linenos="1575 "></span></a><span class="sd">            - If `newcol_func` returns values with length mismatch to the underlying dataframe&#39;s row count</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><a href="#__codelineno-0-1576"><span class="linenos" data-linenos="1576 "></span></a>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><a href="#__codelineno-0-1577"><span class="linenos" data-linenos="1577 "></span></a><span class="sd">        TypeError:</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><a href="#__codelineno-0-1578"><span class="linenos" data-linenos="1578 "></span></a><span class="sd">            - If `stat_name` is not a string</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><a href="#__codelineno-0-1579"><span class="linenos" data-linenos="1579 "></span></a><span class="sd">            - If `pick_cols` is not a list, tuple or set.</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><a href="#__codelineno-0-1580"><span class="linenos" data-linenos="1580 "></span></a><span class="sd">            - If `exclude_cols` is not a list, tuple or set.</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a><a href="#__codelineno-0-1581"><span class="linenos" data-linenos="1581 "></span></a><span class="sd">            - If `custom_cols` is not a dict.</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><a href="#__codelineno-0-1582"><span class="linenos" data-linenos="1582 "></span></a><span class="sd">            - If `newcol_name` is not a string.</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><a href="#__codelineno-0-1583"><span class="linenos" data-linenos="1583 "></span></a><span class="sd">            - If `newcol_func` is uncallable</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><a href="#__codelineno-0-1584"><span class="linenos" data-linenos="1584 "></span></a><span class="sd">            - If `newcol_func` doesn&#39;t have exactly **1** formal parameter</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><a href="#__codelineno-0-1585"><span class="linenos" data-linenos="1585 "></span></a><span class="sd">            - If return value of `newcol_func` is not array-like</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><a href="#__codelineno-0-1586"><span class="linenos" data-linenos="1586 "></span></a><span class="sd">            - If `newcol_idx` is not an integer.</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><a href="#__codelineno-0-1587"><span class="linenos" data-linenos="1587 "></span></a><span class="sd">            - If `newcol_type` is not a valid Polars data type.</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><a href="#__codelineno-0-1588"><span class="linenos" data-linenos="1588 "></span></a><span class="sd">            - If `save_to` is not a string, neither None.</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><a href="#__codelineno-0-1589"><span class="linenos" data-linenos="1589 "></span></a><span class="sd">            - If `save_format` is not a string, neither None.</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><a href="#__codelineno-0-1590"><span class="linenos" data-linenos="1590 "></span></a>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><a href="#__codelineno-0-1591"><span class="linenos" data-linenos="1591 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><a href="#__codelineno-0-1592"><span class="linenos" data-linenos="1592 "></span></a><span class="sd">        1. Ensure at least one forward pass has been executed before accessing `cal`/`mem`/`ittp` statistics to</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a><a href="#__codelineno-0-1593"><span class="linenos" data-linenos="1593 "></span></a><span class="sd">           guarantee valid input capture.</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a><a href="#__codelineno-0-1594"><span class="linenos" data-linenos="1594 "></span></a>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a><a href="#__codelineno-0-1595"><span class="linenos" data-linenos="1595 "></span></a><span class="sd">        2. Table and tree rendering styles can be preconfigured through the properties:</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a><a href="#__codelineno-0-1596"><span class="linenos" data-linenos="1596 "></span></a><span class="sd">            - `table_display_args`</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a><a href="#__codelineno-0-1597"><span class="linenos" data-linenos="1597 "></span></a><span class="sd">            - `table_column_args`</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a><a href="#__codelineno-0-1598"><span class="linenos" data-linenos="1598 "></span></a><span class="sd">            - `tree_fold_args`</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><a href="#__codelineno-0-1599"><span class="linenos" data-linenos="1599 "></span></a><span class="sd">            - `tree_levels_args`</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><a href="#__codelineno-0-1600"><span class="linenos" data-linenos="1600 "></span></a><span class="sd">            - `tree_repeat_block_args`</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><a href="#__codelineno-0-1601"><span class="linenos" data-linenos="1601 "></span></a>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><a href="#__codelineno-0-1602"><span class="linenos" data-linenos="1602 "></span></a><span class="sd">        3. The rendering result will be progressively displayed line-by-line with a time interval.</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a><a href="#__codelineno-0-1603"><span class="linenos" data-linenos="1603 "></span></a><span class="sd">           You can configure this interval through the following steps (must be non-negative):</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><a href="#__codelineno-0-1604"><span class="linenos" data-linenos="1604 "></span></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><a href="#__codelineno-0-1605"><span class="linenos" data-linenos="1605 "></span></a><span class="sd">            from torchmeter import get_config</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a><a href="#__codelineno-0-1606"><span class="linenos" data-linenos="1606 "></span></a>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a><a href="#__codelineno-0-1607"><span class="linenos" data-linenos="1607 "></span></a><span class="sd">            cfg = get_config()</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><a href="#__codelineno-0-1608"><span class="linenos" data-linenos="1608 "></span></a><span class="sd">            cfg.render_interval = 0.5  # unit second, should be non-negative</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><a href="#__codelineno-0-1609"><span class="linenos" data-linenos="1609 "></span></a><span class="sd">            ```</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><a href="#__codelineno-0-1610"><span class="linenos" data-linenos="1610 "></span></a>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a><a href="#__codelineno-0-1611"><span class="linenos" data-linenos="1611 "></span></a><span class="sd">        4. Disable rendering (`show=False`) when only exporting data to reduce computational overhead.</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><a href="#__codelineno-0-1612"><span class="linenos" data-linenos="1612 "></span></a>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a><a href="#__codelineno-0-1613"><span class="linenos" data-linenos="1613 "></span></a><span class="sd">        5. Enable `no_tree` to:</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a><a href="#__codelineno-0-1614"><span class="linenos" data-linenos="1614 "></span></a><span class="sd">            - Enable focused data analysis</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a><a href="#__codelineno-0-1615"><span class="linenos" data-linenos="1615 "></span></a><span class="sd">            - Hide the operation tree for narrow terminals</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a><a href="#__codelineno-0-1616"><span class="linenos" data-linenos="1616 "></span></a><span class="sd">            - Default layout shows tree left + table right (may enforce row separators if space constrained)</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><a href="#__codelineno-0-1617"><span class="linenos" data-linenos="1617 "></span></a>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a><a href="#__codelineno-0-1618"><span class="linenos" data-linenos="1618 "></span></a><span class="sd">        6. Horizontal spacing between tree and table is controlled by `combine.horizon_gap` in global config.</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a><a href="#__codelineno-0-1619"><span class="linenos" data-linenos="1619 "></span></a><span class="sd">           You should promise the value is non-negative.</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a><a href="#__codelineno-0-1620"><span class="linenos" data-linenos="1620 "></span></a>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a><a href="#__codelineno-0-1621"><span class="linenos" data-linenos="1621 "></span></a><span class="sd">        7. When `raw_data=True` displays unformatted values:</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a><a href="#__codelineno-0-1622"><span class="linenos" data-linenos="1622 "></span></a><span class="sd">            - `param`: Parameter counts</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a><a href="#__codelineno-0-1623"><span class="linenos" data-linenos="1623 "></span></a><span class="sd">            - `cal`: FLOPs/MACs counts</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a><a href="#__codelineno-0-1624"><span class="linenos" data-linenos="1624 "></span></a><span class="sd">            - `mem`: Bytes consumed</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><a href="#__codelineno-0-1625"><span class="linenos" data-linenos="1625 "></span></a><span class="sd">            - `ittp`: Median inference time (seconds) and inferences per second per module</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><a href="#__codelineno-0-1626"><span class="linenos" data-linenos="1626 "></span></a>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a><a href="#__codelineno-0-1627"><span class="linenos" data-linenos="1627 "></span></a><span class="sd">        8. Column management:</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><a href="#__codelineno-0-1628"><span class="linenos" data-linenos="1628 "></span></a><span class="sd">            - Use `pick_cols` to reorder columns (validate column names via</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><a href="#__codelineno-0-1629"><span class="linenos" data-linenos="1629 "></span></a><span class="sd">              `metered_instance.table_cols(stat_name)`)</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a><a href="#__codelineno-0-1630"><span class="linenos" data-linenos="1630 "></span></a><span class="sd">            - Processing order: `pick_cols` -&gt; `exclude_cols` -&gt; `custom_cols` -&gt; `newcol`</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a><a href="#__codelineno-0-1631"><span class="linenos" data-linenos="1631 "></span></a><span class="sd">            - Conflicts:</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a><a href="#__codelineno-0-1632"><span class="linenos" data-linenos="1632 "></span></a><span class="sd">                - picked columns override custom/newcol names</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><a href="#__codelineno-0-1633"><span class="linenos" data-linenos="1633 "></span></a><span class="sd">                - exclusions override picks</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><a href="#__codelineno-0-1634"><span class="linenos" data-linenos="1634 "></span></a>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a><a href="#__codelineno-0-1635"><span class="linenos" data-linenos="1635 "></span></a><span class="sd">        9. About `newcol_func`:</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><a href="#__codelineno-0-1636"><span class="linenos" data-linenos="1636 "></span></a><span class="sd">            - must have exactly **1** formal parameter (name irrelevant) that will receive the</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><a href="#__codelineno-0-1637"><span class="linenos" data-linenos="1637 "></span></a><span class="sd">              underlying `polars.DataFrame` of specified statistics.</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a><a href="#__codelineno-0-1638"><span class="linenos" data-linenos="1638 "></span></a><span class="sd">            - Implement logic using the incoming dataframe to return new column values (must be 1D array-like data</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><a href="#__codelineno-0-1639"><span class="linenos" data-linenos="1639 "></span></a><span class="sd">              such as `Series`, `lists`, `ndarrays`, etc.). Note that you can use `val` property to access the</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><a href="#__codelineno-0-1640"><span class="linenos" data-linenos="1640 "></span></a><span class="sd">              raw data for all statistics (for `ittp`, the return will be a tuple made up of the median and iqr of</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><a href="#__codelineno-0-1641"><span class="linenos" data-linenos="1641 "></span></a><span class="sd">              the measurement data sequence).</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><a href="#__codelineno-0-1642"><span class="linenos" data-linenos="1642 "></span></a><span class="sd">            - The example below demonstrates adding a percentage column of the `cal` statistics. Refer to</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a><a href="#__codelineno-0-1643"><span class="linenos" data-linenos="1643 "></span></a><span class="sd">              https://docs.pola.rs/api/python/stable/reference/dataframe/index.html for using `polars.Dataframe`.</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><a href="#__codelineno-0-1644"><span class="linenos" data-linenos="1644 "></span></a>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a><a href="#__codelineno-0-1645"><span class="linenos" data-linenos="1645 "></span></a><span class="sd">        10. The `newcol_idx` parameter mostly follows Python list insertion semantics:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><a href="#__codelineno-0-1646"><span class="linenos" data-linenos="1646 "></span></a><span class="sd">            - Negative values count backward from end (`-1`=`append`)</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a><a href="#__codelineno-0-1647"><span class="linenos" data-linenos="1647 "></span></a><span class="sd">            - `0` inserts at beginning</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><a href="#__codelineno-0-1648"><span class="linenos" data-linenos="1648 "></span></a><span class="sd">            - Values exceeding column count clamp to nearest valid position:</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a><a href="#__codelineno-0-1649"><span class="linenos" data-linenos="1649 "></span></a><span class="sd">              * Negative abs values &gt; column count â†’ insert at start</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a><a href="#__codelineno-0-1650"><span class="linenos" data-linenos="1650 "></span></a><span class="sd">              * Positive values &gt; column count â†’ append at end</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a><a href="#__codelineno-0-1651"><span class="linenos" data-linenos="1651 "></span></a>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a><a href="#__codelineno-0-1652"><span class="linenos" data-linenos="1652 "></span></a><span class="sd">        12. Session persistence:</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a><a href="#__codelineno-0-1653"><span class="linenos" data-linenos="1653 "></span></a><span class="sd">            - `keep_new_col` retains created columns</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a><a href="#__codelineno-0-1654"><span class="linenos" data-linenos="1654 "></span></a><span class="sd">            - `keep_custom_name` preserves renamed columns</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a><a href="#__codelineno-0-1655"><span class="linenos" data-linenos="1655 "></span></a>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a><a href="#__codelineno-0-1656"><span class="linenos" data-linenos="1656 "></span></a><span class="sd">        13. Export paths:</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a><a href="#__codelineno-0-1657"><span class="linenos" data-linenos="1657 "></span></a><span class="sd">            - Directory paths require explicit `save_format`</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><a href="#__codelineno-0-1658"><span class="linenos" data-linenos="1658 "></span></a><span class="sd">            - File paths auto-detect format from extension unless `save_format` overrides</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><a href="#__codelineno-0-1659"><span class="linenos" data-linenos="1659 "></span></a>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><a href="#__codelineno-0-1660"><span class="linenos" data-linenos="1660 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a><a href="#__codelineno-0-1661"><span class="linenos" data-linenos="1661 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><a href="#__codelineno-0-1662"><span class="linenos" data-linenos="1662 "></span></a><span class="sd">        import torch</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><a href="#__codelineno-0-1663"><span class="linenos" data-linenos="1663 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a><a href="#__codelineno-0-1664"><span class="linenos" data-linenos="1664 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a><a href="#__codelineno-0-1665"><span class="linenos" data-linenos="1665 "></span></a>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><a href="#__codelineno-0-1666"><span class="linenos" data-linenos="1666 "></span></a><span class="sd">        # wrap your model with Meter</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><a href="#__codelineno-0-1667"><span class="linenos" data-linenos="1667 "></span></a><span class="sd">        underlying_model = models.alexnet()</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><a href="#__codelineno-0-1668"><span class="linenos" data-linenos="1668 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><a href="#__codelineno-0-1669"><span class="linenos" data-linenos="1669 "></span></a>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><a href="#__codelineno-0-1670"><span class="linenos" data-linenos="1670 "></span></a><span class="sd">        # execute a forward inference (necessary, to provide input data)</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><a href="#__codelineno-0-1671"><span class="linenos" data-linenos="1671 "></span></a><span class="sd">        input = torch.randn(1, 3, 224, 224)</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><a href="#__codelineno-0-1672"><span class="linenos" data-linenos="1672 "></span></a><span class="sd">        model(input)</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a><a href="#__codelineno-0-1673"><span class="linenos" data-linenos="1673 "></span></a>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><a href="#__codelineno-0-1674"><span class="linenos" data-linenos="1674 "></span></a><span class="sd">        # check column names of cal tabel</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><a href="#__codelineno-0-1675"><span class="linenos" data-linenos="1675 "></span></a><span class="sd">        print(model.table_cols(&quot;cal&quot;))</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><a href="#__codelineno-0-1676"><span class="linenos" data-linenos="1676 "></span></a><span class="sd">        # (&#39;Operation_Id&#39;, &#39;Operation_Name&#39;, &#39;Operation_Type&#39;, &#39;Kernel_Size&#39;, &#39;Bias&#39;,</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><a href="#__codelineno-0-1677"><span class="linenos" data-linenos="1677 "></span></a><span class="sd">        # &#39;Input&#39;, &#39;Output&#39;, &#39;MACs&#39;, &#39;FLOPs&#39;)</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><a href="#__codelineno-0-1678"><span class="linenos" data-linenos="1678 "></span></a>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><a href="#__codelineno-0-1679"><span class="linenos" data-linenos="1679 "></span></a>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><a href="#__codelineno-0-1680"><span class="linenos" data-linenos="1680 "></span></a><span class="sd">        def newcol_logic(df):</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><a href="#__codelineno-0-1681"><span class="linenos" data-linenos="1681 "></span></a><span class="sd">            flops_col = df[&quot;FLOPs&quot;]</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><a href="#__codelineno-0-1682"><span class="linenos" data-linenos="1682 "></span></a><span class="sd">            return flops_col.map_elements(lambda x: f&quot;{100 * x / metered_model.cal.Flops:.4f} %&quot;)</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><a href="#__codelineno-0-1683"><span class="linenos" data-linenos="1683 "></span></a>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><a href="#__codelineno-0-1684"><span class="linenos" data-linenos="1684 "></span></a>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><a href="#__codelineno-0-1685"><span class="linenos" data-linenos="1685 "></span></a><span class="sd">        # Customized profile with column operations</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><a href="#__codelineno-0-1686"><span class="linenos" data-linenos="1686 "></span></a><span class="sd">        model.profile(</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><a href="#__codelineno-0-1687"><span class="linenos" data-linenos="1687 "></span></a><span class="sd">            &quot;cal&quot;,</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><a href="#__codelineno-0-1688"><span class="linenos" data-linenos="1688 "></span></a><span class="sd">            # render and display immediately</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><a href="#__codelineno-0-1689"><span class="linenos" data-linenos="1689 "></span></a><span class="sd">            show=True,</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><a href="#__codelineno-0-1690"><span class="linenos" data-linenos="1690 "></span></a><span class="sd">            no_tree=True,</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><a href="#__codelineno-0-1691"><span class="linenos" data-linenos="1691 "></span></a><span class="sd">            raw_data=False,</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a><a href="#__codelineno-0-1692"><span class="linenos" data-linenos="1692 "></span></a><span class="sd">            # columns management</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><a href="#__codelineno-0-1693"><span class="linenos" data-linenos="1693 "></span></a><span class="sd">            exclude_cols=[&quot;Kernel_Size&quot;, &quot;Bias&quot;],</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><a href="#__codelineno-0-1694"><span class="linenos" data-linenos="1694 "></span></a><span class="sd">            custom_cols={&quot;Operation_Id&quot;: &quot;ID&quot;, &quot;Operation_Name&quot;: &quot;Module Name&quot;, &quot;Operation_Type&quot;: &quot;Module Type&quot;},</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><a href="#__codelineno-0-1695"><span class="linenos" data-linenos="1695 "></span></a><span class="sd">            newcol_name=&quot;Percentage&quot;,</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><a href="#__codelineno-0-1696"><span class="linenos" data-linenos="1696 "></span></a><span class="sd">            newcol_func=newcol_logic,</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a><a href="#__codelineno-0-1697"><span class="linenos" data-linenos="1697 "></span></a><span class="sd">            newcol_type=str,</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a><a href="#__codelineno-0-1698"><span class="linenos" data-linenos="1698 "></span></a><span class="sd">            newcol_idx=-1,</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a><a href="#__codelineno-0-1699"><span class="linenos" data-linenos="1699 "></span></a><span class="sd">            # export</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a><a href="#__codelineno-0-1700"><span class="linenos" data-linenos="1700 "></span></a><span class="sd">            save_to=&quot;./cal_profile.xlsx&quot;,</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a><a href="#__codelineno-0-1701"><span class="linenos" data-linenos="1701 "></span></a><span class="sd">            save_format=&quot;xlsx&quot;,</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a><a href="#__codelineno-0-1702"><span class="linenos" data-linenos="1702 "></span></a><span class="sd">        )</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a><a href="#__codelineno-0-1703"><span class="linenos" data-linenos="1703 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><a href="#__codelineno-0-1704"><span class="linenos" data-linenos="1704 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a><a href="#__codelineno-0-1705"><span class="linenos" data-linenos="1705 "></span></a>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a><a href="#__codelineno-0-1706"><span class="linenos" data-linenos="1706 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">rich.rule</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rule</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a><a href="#__codelineno-0-1707"><span class="linenos" data-linenos="1707 "></span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">rich.layout</span><span class="w"> </span><span class="kn">import</span> <span class="n">Layout</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a><a href="#__codelineno-0-1708"><span class="linenos" data-linenos="1708 "></span></a>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a><a href="#__codelineno-0-1709"><span class="linenos" data-linenos="1709 "></span></a>    <span class="c1"># the horizontal gap between tree and table</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a><a href="#__codelineno-0-1710"><span class="linenos" data-linenos="1710 "></span></a>    <span class="n">TREE_TABLE_GAP</span> <span class="o">=</span> <span class="n">__cfg__</span><span class="o">.</span><span class="n">combine</span><span class="o">.</span><span class="n">horizon_gap</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a><a href="#__codelineno-0-1711"><span class="linenos" data-linenos="1711 "></span></a>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a><a href="#__codelineno-0-1712"><span class="linenos" data-linenos="1712 "></span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stat_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a><a href="#__codelineno-0-1713"><span class="linenos" data-linenos="1713 "></span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stat_name must be a string, but got `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">stat_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a><a href="#__codelineno-0-1714"><span class="linenos" data-linenos="1714 "></span></a>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a><a href="#__codelineno-0-1715"><span class="linenos" data-linenos="1715 "></span></a>    <span class="k">if</span> <span class="n">TREE_TABLE_GAP</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a><a href="#__codelineno-0-1716"><span class="linenos" data-linenos="1716 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><a href="#__codelineno-0-1717"><span class="linenos" data-linenos="1717 "></span></a>            <span class="s2">&quot;The gap between the rendered tree and the rendered table should be non-negative, &quot;</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a><a href="#__codelineno-0-1718"><span class="linenos" data-linenos="1718 "></span></a>            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;but got `</span><span class="si">{</span><span class="n">TREE_TABLE_GAP</span><span class="si">}</span><span class="s2">`.&quot;</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><a href="#__codelineno-0-1719"><span class="linenos" data-linenos="1719 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><a href="#__codelineno-0-1720"><span class="linenos" data-linenos="1720 "></span></a>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><a href="#__codelineno-0-1721"><span class="linenos" data-linenos="1721 "></span></a>    <span class="n">stat</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_name</span><span class="p">)</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><a href="#__codelineno-0-1722"><span class="linenos" data-linenos="1722 "></span></a>    <span class="n">tb</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_renderer</span><span class="p">(</span><span class="n">stat_name</span><span class="o">=</span><span class="n">stat_name</span><span class="p">,</span> <span class="o">**</span><span class="n">tb_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a><a href="#__codelineno-0-1723"><span class="linenos" data-linenos="1723 "></span></a>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a><a href="#__codelineno-0-1724"><span class="linenos" data-linenos="1724 "></span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">show</span><span class="p">:</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><a href="#__codelineno-0-1725"><span class="linenos" data-linenos="1725 "></span></a>        <span class="k">return</span> <span class="n">tb</span><span class="p">,</span> <span class="n">data</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a><a href="#__codelineno-0-1726"><span class="linenos" data-linenos="1726 "></span></a>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><a href="#__codelineno-0-1727"><span class="linenos" data-linenos="1727 "></span></a>    <span class="n">tree</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">no_tree</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><a href="#__codelineno-0-1728"><span class="linenos" data-linenos="1728 "></span></a>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a><a href="#__codelineno-0-1729"><span class="linenos" data-linenos="1729 "></span></a>    <span class="n">console</span> <span class="o">=</span> <span class="n">get_console</span><span class="p">()</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a><a href="#__codelineno-0-1730"><span class="linenos" data-linenos="1730 "></span></a>    <span class="n">tree_width</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="o">.</span><span class="n">maximum</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">no_tree</span> <span class="k">else</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a><a href="#__codelineno-0-1731"><span class="linenos" data-linenos="1731 "></span></a>    <span class="n">desirable_tb_width</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">tb</span><span class="p">)</span><span class="o">.</span><span class="n">maximum</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a><a href="#__codelineno-0-1732"><span class="linenos" data-linenos="1732 "></span></a>    <span class="n">actual_tb_width</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">desirable_tb_width</span><span class="p">,</span> <span class="n">console</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">tree_width</span> <span class="o">-</span> <span class="n">TREE_TABLE_GAP</span><span class="p">)</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a><a href="#__codelineno-0-1733"><span class="linenos" data-linenos="1733 "></span></a>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a><a href="#__codelineno-0-1734"><span class="linenos" data-linenos="1734 "></span></a>    <span class="k">if</span> <span class="n">actual_tb_width</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># 5 is the minimum width of table</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><a href="#__codelineno-0-1735"><span class="linenos" data-linenos="1735 "></span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a><a href="#__codelineno-0-1736"><span class="linenos" data-linenos="1736 "></span></a>            <span class="s2">&quot;The width of the terminal is too small, try to maximize the window or &quot;</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a><a href="#__codelineno-0-1737"><span class="linenos" data-linenos="1737 "></span></a>            <span class="o">+</span> <span class="s2">&quot;set a smaller `horizon_gap` value in config and try again.&quot;</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a><a href="#__codelineno-0-1738"><span class="linenos" data-linenos="1738 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a><a href="#__codelineno-0-1739"><span class="linenos" data-linenos="1739 "></span></a>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a><a href="#__codelineno-0-1740"><span class="linenos" data-linenos="1740 "></span></a>    <span class="c1"># when some cells in the table is overflown, we need to show a line between rows</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a><a href="#__codelineno-0-1741"><span class="linenos" data-linenos="1741 "></span></a>    <span class="k">if</span> <span class="n">actual_tb_width</span> <span class="o">&lt;</span> <span class="n">desirable_tb_width</span><span class="p">:</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a><a href="#__codelineno-0-1742"><span class="linenos" data-linenos="1742 "></span></a>        <span class="n">tb</span><span class="o">.</span><span class="n">show_lines</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a><a href="#__codelineno-0-1743"><span class="linenos" data-linenos="1743 "></span></a>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a><a href="#__codelineno-0-1744"><span class="linenos" data-linenos="1744 "></span></a>    <span class="c1"># get main content(i.e. tree &amp; statistics table)</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a><a href="#__codelineno-0-1745"><span class="linenos" data-linenos="1745 "></span></a>    <span class="k">if</span> <span class="n">no_tree</span><span class="p">:</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a><a href="#__codelineno-0-1746"><span class="linenos" data-linenos="1746 "></span></a>        <span class="n">main_content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Table</span><span class="p">,</span> <span class="n">Layout</span><span class="p">]</span> <span class="o">=</span> <span class="n">tb</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a><a href="#__codelineno-0-1747"><span class="linenos" data-linenos="1747 "></span></a>        <span class="n">tree_height</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a><a href="#__codelineno-0-1748"><span class="linenos" data-linenos="1748 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a><a href="#__codelineno-0-1749"><span class="linenos" data-linenos="1749 "></span></a>        <span class="n">main_content</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">()</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a><a href="#__codelineno-0-1750"><span class="linenos" data-linenos="1750 "></span></a>        <span class="n">main_content</span><span class="o">.</span><span class="n">split_row</span><span class="p">(</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a><a href="#__codelineno-0-1751"><span class="linenos" data-linenos="1751 "></span></a>            <span class="n">Layout</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">tree_width</span> <span class="o">+</span> <span class="n">TREE_TABLE_GAP</span><span class="p">),</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a><a href="#__codelineno-0-1752"><span class="linenos" data-linenos="1752 "></span></a>            <span class="n">Layout</span><span class="p">(</span><span class="n">tb</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">actual_tb_width</span><span class="p">),</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a><a href="#__codelineno-0-1753"><span class="linenos" data-linenos="1753 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a><a href="#__codelineno-0-1754"><span class="linenos" data-linenos="1754 "></span></a>        <span class="n">tree_height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">console</span><span class="o">.</span><span class="n">render_lines</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a><a href="#__codelineno-0-1755"><span class="linenos" data-linenos="1755 "></span></a>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a><a href="#__codelineno-0-1756"><span class="linenos" data-linenos="1756 "></span></a>    <span class="n">temp_options</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">update_width</span><span class="p">(</span><span class="n">actual_tb_width</span><span class="p">)</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a><a href="#__codelineno-0-1757"><span class="linenos" data-linenos="1757 "></span></a>    <span class="n">tb_height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">console</span><span class="o">.</span><span class="n">render_lines</span><span class="p">(</span><span class="n">tb</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">temp_options</span><span class="p">))</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a><a href="#__codelineno-0-1758"><span class="linenos" data-linenos="1758 "></span></a>    <span class="n">main_content_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tree_height</span><span class="p">,</span> <span class="n">tb_height</span><span class="p">)</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a><a href="#__codelineno-0-1759"><span class="linenos" data-linenos="1759 "></span></a>    <span class="n">main_content_width</span> <span class="o">=</span> <span class="n">tree_width</span> <span class="o">+</span> <span class="n">actual_tb_width</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span> <span class="k">if</span> <span class="n">no_tree</span> <span class="k">else</span> <span class="n">TREE_TABLE_GAP</span><span class="p">)</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a><a href="#__codelineno-0-1760"><span class="linenos" data-linenos="1760 "></span></a>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a><a href="#__codelineno-0-1761"><span class="linenos" data-linenos="1761 "></span></a>    <span class="c1"># get footer content</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a><a href="#__codelineno-0-1762"><span class="linenos" data-linenos="1762 "></span></a>    <span class="n">footer</span> <span class="o">=</span> <span class="n">Columns</span><span class="p">(</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a><a href="#__codelineno-0-1763"><span class="linenos" data-linenos="1763 "></span></a>        <span class="n">title</span><span class="o">=</span><span class="n">Rule</span><span class="p">(</span><span class="s2">&quot;[gray54]s u m m a r y[/]&quot;</span><span class="p">,</span> <span class="n">characters</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;gray54&quot;</span><span class="p">),</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a><a href="#__codelineno-0-1764"><span class="linenos" data-linenos="1764 "></span></a>        <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a><a href="#__codelineno-0-1765"><span class="linenos" data-linenos="1765 "></span></a>        <span class="n">equal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a><a href="#__codelineno-0-1766"><span class="linenos" data-linenos="1766 "></span></a>        <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a><a href="#__codelineno-0-1767"><span class="linenos" data-linenos="1767 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a><a href="#__codelineno-0-1768"><span class="linenos" data-linenos="1768 "></span></a>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a><a href="#__codelineno-0-1769"><span class="linenos" data-linenos="1769 "></span></a>    <span class="n">model_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_info</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a><a href="#__codelineno-0-1770"><span class="linenos" data-linenos="1770 "></span></a>    <span class="n">stat_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_info</span><span class="p">(</span><span class="n">stat_or_statname</span><span class="o">=</span><span class="n">stat</span><span class="p">,</span> <span class="n">show_warning</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a><a href="#__codelineno-0-1771"><span class="linenos" data-linenos="1771 "></span></a>    <span class="n">model_info</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;dim&quot;</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a><a href="#__codelineno-0-1772"><span class="linenos" data-linenos="1772 "></span></a>    <span class="n">stat_info</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;dim&quot;</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a><a href="#__codelineno-0-1773"><span class="linenos" data-linenos="1773 "></span></a>    <span class="n">footer</span><span class="o">.</span><span class="n">add_renderable</span><span class="p">(</span><span class="n">model_info</span><span class="p">)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a><a href="#__codelineno-0-1774"><span class="linenos" data-linenos="1774 "></span></a>    <span class="n">footer</span><span class="o">.</span><span class="n">add_renderable</span><span class="p">(</span><span class="n">stat_info</span><span class="p">)</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a><a href="#__codelineno-0-1775"><span class="linenos" data-linenos="1775 "></span></a>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a><a href="#__codelineno-0-1776"><span class="linenos" data-linenos="1776 "></span></a>    <span class="n">temp_options</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">update_width</span><span class="p">(</span><span class="n">main_content_width</span><span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a><a href="#__codelineno-0-1777"><span class="linenos" data-linenos="1777 "></span></a>    <span class="n">footer_height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">console</span><span class="o">.</span><span class="n">render_lines</span><span class="p">(</span><span class="n">footer</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">temp_options</span><span class="p">))</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a><a href="#__codelineno-0-1778"><span class="linenos" data-linenos="1778 "></span></a>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a><a href="#__codelineno-0-1779"><span class="linenos" data-linenos="1779 "></span></a>    <span class="c1"># render profile</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a><a href="#__codelineno-0-1780"><span class="linenos" data-linenos="1780 "></span></a>    <span class="n">canvas</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">()</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a><a href="#__codelineno-0-1781"><span class="linenos" data-linenos="1781 "></span></a>    <span class="n">canvas</span><span class="o">.</span><span class="n">split_column</span><span class="p">(</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a><a href="#__codelineno-0-1782"><span class="linenos" data-linenos="1782 "></span></a>        <span class="n">Layout</span><span class="p">(</span><span class="n">main_content</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">main_content_height</span><span class="p">),</span> <span class="n">Layout</span><span class="p">(</span><span class="n">footer</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">footer_height</span><span class="p">)</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a><a href="#__codelineno-0-1783"><span class="linenos" data-linenos="1783 "></span></a>    <span class="p">)</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><a href="#__codelineno-0-1784"><span class="linenos" data-linenos="1784 "></span></a>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><a href="#__codelineno-0-1785"><span class="linenos" data-linenos="1785 "></span></a>    <span class="n">origin_width</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">width</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a><a href="#__codelineno-0-1786"><span class="linenos" data-linenos="1786 "></span></a>    <span class="n">origin_height</span> <span class="o">=</span> <span class="n">console</span><span class="o">.</span><span class="n">height</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><a href="#__codelineno-0-1787"><span class="linenos" data-linenos="1787 "></span></a>    <span class="n">console</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">main_content_width</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><a href="#__codelineno-0-1788"><span class="linenos" data-linenos="1788 "></span></a>    <span class="n">console</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">main_content_height</span> <span class="o">+</span> <span class="n">footer_height</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><a href="#__codelineno-0-1789"><span class="linenos" data-linenos="1789 "></span></a>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><a href="#__codelineno-0-1790"><span class="linenos" data-linenos="1790 "></span></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><a href="#__codelineno-0-1791"><span class="linenos" data-linenos="1791 "></span></a>        <span class="n">render_perline</span><span class="p">(</span><span class="n">renderable</span><span class="o">=</span><span class="n">canvas</span><span class="p">)</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><a href="#__codelineno-0-1792"><span class="linenos" data-linenos="1792 "></span></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><a href="#__codelineno-0-1793"><span class="linenos" data-linenos="1793 "></span></a>        <span class="c1"># if user interupts the rendering when render_interval &gt; 0</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><a href="#__codelineno-0-1794"><span class="linenos" data-linenos="1794 "></span></a>        <span class="c1"># still restore the console size</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><a href="#__codelineno-0-1795"><span class="linenos" data-linenos="1795 "></span></a>        <span class="n">console</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">origin_width</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><a href="#__codelineno-0-1796"><span class="linenos" data-linenos="1796 "></span></a>        <span class="n">console</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">origin_height</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><a href="#__codelineno-0-1797"><span class="linenos" data-linenos="1797 "></span></a>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a><a href="#__codelineno-0-1798"><span class="linenos" data-linenos="1798 "></span></a>    <span class="k">return</span> <span class="n">tb</span><span class="p">,</span> <span class="n">data</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.rebase" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">rebase</span>


<a href="#torchmeter.core.Meter.rebase" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rebase</span><span class="p">(</span><span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Meter</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rebases the Meter instance to a specific node in the operation tree.</p>
<p>This method allows the Meter instance to focus on a specific node in the operation tree,
effectively treating that node as the new root of a new Meter instance. If the provided
node ID is "0", the original Meter instance is returned unchanged.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the node to rebase to. Must be a valid node ID in the operation tree.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Meter</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" href="#torchmeter.core.Meter">Meter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new Meter instance with the specified node as the root.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>node_id</code> is not a string.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>node_id</code> does not exist in the operation tree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Use <code>Meter(your_model).subnodes</code> to retrieve a list of valid node IDs.</li>
<li>If <code>node_id</code> is "0", the original Meter instance is returned without modification.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos="5 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos="6 "></span></a><span class="n">rebased_model</span> <span class="o">=</span> <span class="n">metered_model</span><span class="o">.</span><span class="n">rebase</span><span class="p">(</span><span class="s2">&quot;5&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos="7 "></span></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos="8 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>  <span class="c1"># Meter(model=0 ResNet: ResNet, device=cpu)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos="9 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">rebased_model</span><span class="p">)</span>  <span class="c1"># Meter(model=0 Sequential: Sequential, device=cpu)</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><a href="#__codelineno-0-1207"><span class="linenos" data-linenos="1207 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">rebase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Meter</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><a href="#__codelineno-0-1208"><span class="linenos" data-linenos="1208 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rebases the Meter instance to a specific node in the operation tree.</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><a href="#__codelineno-0-1209"><span class="linenos" data-linenos="1209 "></span></a>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><a href="#__codelineno-0-1210"><span class="linenos" data-linenos="1210 "></span></a><span class="sd">    This method allows the Meter instance to focus on a specific node in the operation tree,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><a href="#__codelineno-0-1211"><span class="linenos" data-linenos="1211 "></span></a><span class="sd">    effectively treating that node as the new root of a new Meter instance. If the provided</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><a href="#__codelineno-0-1212"><span class="linenos" data-linenos="1212 "></span></a><span class="sd">    node ID is &quot;0&quot;, the original Meter instance is returned unchanged.</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><a href="#__codelineno-0-1213"><span class="linenos" data-linenos="1213 "></span></a>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><a href="#__codelineno-0-1214"><span class="linenos" data-linenos="1214 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><a href="#__codelineno-0-1215"><span class="linenos" data-linenos="1215 "></span></a><span class="sd">        node_id (str): The ID of the node to rebase to. Must be a valid node ID in the operation tree.</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><a href="#__codelineno-0-1216"><span class="linenos" data-linenos="1216 "></span></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><a href="#__codelineno-0-1217"><span class="linenos" data-linenos="1217 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><a href="#__codelineno-0-1218"><span class="linenos" data-linenos="1218 "></span></a><span class="sd">        Meter: A new Meter instance with the specified node as the root.</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><a href="#__codelineno-0-1219"><span class="linenos" data-linenos="1219 "></span></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><a href="#__codelineno-0-1220"><span class="linenos" data-linenos="1220 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><a href="#__codelineno-0-1221"><span class="linenos" data-linenos="1221 "></span></a><span class="sd">        TypeError: If `node_id` is not a string.</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><a href="#__codelineno-0-1222"><span class="linenos" data-linenos="1222 "></span></a><span class="sd">        ValueError: If `node_id` does not exist in the operation tree.</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><a href="#__codelineno-0-1223"><span class="linenos" data-linenos="1223 "></span></a>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><a href="#__codelineno-0-1224"><span class="linenos" data-linenos="1224 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><a href="#__codelineno-0-1225"><span class="linenos" data-linenos="1225 "></span></a><span class="sd">        - Use `Meter(your_model).subnodes` to retrieve a list of valid node IDs.</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><a href="#__codelineno-0-1226"><span class="linenos" data-linenos="1226 "></span></a><span class="sd">        - If `node_id` is &quot;0&quot;, the original Meter instance is returned without modification.</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><a href="#__codelineno-0-1227"><span class="linenos" data-linenos="1227 "></span></a>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><a href="#__codelineno-0-1228"><span class="linenos" data-linenos="1228 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><a href="#__codelineno-0-1229"><span class="linenos" data-linenos="1229 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><a href="#__codelineno-0-1230"><span class="linenos" data-linenos="1230 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><a href="#__codelineno-0-1231"><span class="linenos" data-linenos="1231 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><a href="#__codelineno-0-1232"><span class="linenos" data-linenos="1232 "></span></a>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><a href="#__codelineno-0-1233"><span class="linenos" data-linenos="1233 "></span></a><span class="sd">        underlying_model = models.resnet18()</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><a href="#__codelineno-0-1234"><span class="linenos" data-linenos="1234 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><a href="#__codelineno-0-1235"><span class="linenos" data-linenos="1235 "></span></a><span class="sd">        rebased_model = metered_model.rebase(&quot;5&quot;)</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><a href="#__codelineno-0-1236"><span class="linenos" data-linenos="1236 "></span></a>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><a href="#__codelineno-0-1237"><span class="linenos" data-linenos="1237 "></span></a><span class="sd">        print(model)  # Meter(model=0 ResNet: ResNet, device=cpu)</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><a href="#__codelineno-0-1238"><span class="linenos" data-linenos="1238 "></span></a><span class="sd">        print(rebased_model)  # Meter(model=0 Sequential: Sequential, device=cpu)</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><a href="#__codelineno-0-1239"><span class="linenos" data-linenos="1239 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><a href="#__codelineno-0-1240"><span class="linenos" data-linenos="1240 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><a href="#__codelineno-0-1241"><span class="linenos" data-linenos="1241 "></span></a>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><a href="#__codelineno-0-1242"><span class="linenos" data-linenos="1242 "></span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><a href="#__codelineno-0-1243"><span class="linenos" data-linenos="1243 "></span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;node_id must be a string, but got `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><a href="#__codelineno-0-1244"><span class="linenos" data-linenos="1244 "></span></a>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><a href="#__codelineno-0-1245"><span class="linenos" data-linenos="1245 "></span></a>    <span class="k">if</span> <span class="n">node_id</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><a href="#__codelineno-0-1246"><span class="linenos" data-linenos="1246 "></span></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><a href="#__codelineno-0-1247"><span class="linenos" data-linenos="1247 "></span></a>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><a href="#__codelineno-0-1248"><span class="linenos" data-linenos="1248 "></span></a>    <span class="n">id_generator</span> <span class="o">=</span> <span class="p">((</span><span class="n">node_idx</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">node_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">node_idx</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">))</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><a href="#__codelineno-0-1249"><span class="linenos" data-linenos="1249 "></span></a>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><a href="#__codelineno-0-1250"><span class="linenos" data-linenos="1250 "></span></a>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">valid_id</span> <span class="ow">in</span> <span class="n">id_generator</span><span class="p">:</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><a href="#__codelineno-0-1251"><span class="linenos" data-linenos="1251 "></span></a>        <span class="k">if</span> <span class="n">node_id</span> <span class="o">==</span> <span class="n">valid_id</span><span class="p">:</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><a href="#__codelineno-0-1252"><span class="linenos" data-linenos="1252 "></span></a>            <span class="n">new_base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><a href="#__codelineno-0-1253"><span class="linenos" data-linenos="1253 "></span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">new_base</span><span class="o">.</span><span class="n">operation</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><a href="#__codelineno-0-1254"><span class="linenos" data-linenos="1254 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><a href="#__codelineno-0-1255"><span class="linenos" data-linenos="1255 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid node_id: </span><span class="si">{</span><span class="n">node_id</span><span class="si">}</span><span class="s2">. Use `Meter(your_model).subnodes` to check valid ones.&quot;</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.stat_info" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">stat_info</span>


<a href="#torchmeter.core.Meter.stat_info" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">stat_info</span><span class="p">(</span><span class="n">stat_or_statname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Statistics</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">show_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates a formatted summary of the specified statistics.</p>
<p>This method provides a summary of the given statistics, including its name and the crucial data
about this statistics. However, sometimes there may exist some modules which is defined but not
explicitly called, or some modules that its calculation measurement logic is not defined in this
version. To prevent confusing user, we will show inaccuracies warnings in the summary. If you don't
want to see these warnings, you can set <code>show_warning</code> to <code>False</code> manually.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stat_or_statname</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torchmeter.statistic.Statistics">Statistics</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the statistics or the statistics object itself.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_warning</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display warnings about potential inaccuracies. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Text</code></td>            <td>
                  <code><span title="rich.text.Text">Text</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>rich.Text</code> object containing the formatted summary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>stat_or_statname</code> is neither a string nor a <code>Statistics</code> object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>
<p>The main content will be obtained from the <code>crucial_data</code> property of the statistics object, which is
  defined in the corresponding statistics class.</p>
</li>
<li>
<p>For <code>ittp</code>, the number of repeated measurements, namely <code>Benchmark Times</code>, will be additionally
  displayed. This value can be accessed or modified through the `ittp_benchmark_time' attribute.</p>
</li>
<li>
<p><code>show_warning</code> option is keyword-only argument, so you should use it through its keyword name.</p>
</li>
<li>
<p>Warnings are only shown for the following two statistics: calculation (<code>cal</code>) and memory (<code>mem</code>). Because
  only these two statistics are affected by the no called modules or the not supported mudules.</p>
</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">randn</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">vit_b_16</span><span class="p">()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># using statistics name</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">stat_info</span><span class="p">(</span><span class="s2">&quot;param&quot;</span><span class="p">))</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a><span class="c1"># using statistics object</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="n">cal</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cal</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">stat_info</span><span class="p">(</span><span class="n">cal</span><span class="p">))</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="c1"># not show warnings</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">stat_info</span><span class="p">(</span><span class="s2">&quot;mem&quot;</span><span class="p">,</span> <span class="n">show_warning</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><a href="#__codelineno-0-1257"><span class="linenos" data-linenos="1257 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">stat_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_or_statname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Statistics</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">show_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>  <span class="c1"># noqa: C901</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><a href="#__codelineno-0-1258"><span class="linenos" data-linenos="1258 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a formatted summary of the specified statistics.</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><a href="#__codelineno-0-1259"><span class="linenos" data-linenos="1259 "></span></a>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><a href="#__codelineno-0-1260"><span class="linenos" data-linenos="1260 "></span></a><span class="sd">    This method provides a summary of the given statistics, including its name and the crucial data</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><a href="#__codelineno-0-1261"><span class="linenos" data-linenos="1261 "></span></a><span class="sd">    about this statistics. However, sometimes there may exist some modules which is defined but not</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><a href="#__codelineno-0-1262"><span class="linenos" data-linenos="1262 "></span></a><span class="sd">    explicitly called, or some modules that its calculation measurement logic is not defined in this</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><a href="#__codelineno-0-1263"><span class="linenos" data-linenos="1263 "></span></a><span class="sd">    version. To prevent confusing user, we will show inaccuracies warnings in the summary. If you don&#39;t</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><a href="#__codelineno-0-1264"><span class="linenos" data-linenos="1264 "></span></a><span class="sd">    want to see these warnings, you can set `show_warning` to `False` manually.</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><a href="#__codelineno-0-1265"><span class="linenos" data-linenos="1265 "></span></a>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><a href="#__codelineno-0-1266"><span class="linenos" data-linenos="1266 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><a href="#__codelineno-0-1267"><span class="linenos" data-linenos="1267 "></span></a><span class="sd">        stat_or_statname (Union[str, Statistics]): The name of the statistics or the statistics object itself.</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><a href="#__codelineno-0-1268"><span class="linenos" data-linenos="1268 "></span></a><span class="sd">        show_warning (bool): Whether to display warnings about potential inaccuracies. Defaults to True.</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><a href="#__codelineno-0-1269"><span class="linenos" data-linenos="1269 "></span></a>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><a href="#__codelineno-0-1270"><span class="linenos" data-linenos="1270 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><a href="#__codelineno-0-1271"><span class="linenos" data-linenos="1271 "></span></a><span class="sd">        Text: A `rich.Text` object containing the formatted summary.</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><a href="#__codelineno-0-1272"><span class="linenos" data-linenos="1272 "></span></a>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><a href="#__codelineno-0-1273"><span class="linenos" data-linenos="1273 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><a href="#__codelineno-0-1274"><span class="linenos" data-linenos="1274 "></span></a><span class="sd">        TypeError: If `stat_or_statname` is neither a string nor a `Statistics` object.</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><a href="#__codelineno-0-1275"><span class="linenos" data-linenos="1275 "></span></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><a href="#__codelineno-0-1276"><span class="linenos" data-linenos="1276 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><a href="#__codelineno-0-1277"><span class="linenos" data-linenos="1277 "></span></a><span class="sd">        - The main content will be obtained from the `crucial_data` property of the statistics object, which is</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><a href="#__codelineno-0-1278"><span class="linenos" data-linenos="1278 "></span></a><span class="sd">          defined in the corresponding statistics class.</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><a href="#__codelineno-0-1279"><span class="linenos" data-linenos="1279 "></span></a>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><a href="#__codelineno-0-1280"><span class="linenos" data-linenos="1280 "></span></a><span class="sd">        - For `ittp`, the number of repeated measurements, namely `Benchmark Times`, will be additionally</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><a href="#__codelineno-0-1281"><span class="linenos" data-linenos="1281 "></span></a><span class="sd">          displayed. This value can be accessed or modified through the `ittp_benchmark_time&#39; attribute.</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><a href="#__codelineno-0-1282"><span class="linenos" data-linenos="1282 "></span></a>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><a href="#__codelineno-0-1283"><span class="linenos" data-linenos="1283 "></span></a><span class="sd">        - `show_warning` option is keyword-only argument, so you should use it through its keyword name.</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><a href="#__codelineno-0-1284"><span class="linenos" data-linenos="1284 "></span></a>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><a href="#__codelineno-0-1285"><span class="linenos" data-linenos="1285 "></span></a><span class="sd">        - Warnings are only shown for the following two statistics: calculation (`cal`) and memory (`mem`). Because</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><a href="#__codelineno-0-1286"><span class="linenos" data-linenos="1286 "></span></a><span class="sd">          only these two statistics are affected by the no called modules or the not supported mudules.</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><a href="#__codelineno-0-1287"><span class="linenos" data-linenos="1287 "></span></a>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><a href="#__codelineno-0-1288"><span class="linenos" data-linenos="1288 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><a href="#__codelineno-0-1289"><span class="linenos" data-linenos="1289 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><a href="#__codelineno-0-1290"><span class="linenos" data-linenos="1290 "></span></a><span class="sd">        from torch import randn</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><a href="#__codelineno-0-1291"><span class="linenos" data-linenos="1291 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><a href="#__codelineno-0-1292"><span class="linenos" data-linenos="1292 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><a href="#__codelineno-0-1293"><span class="linenos" data-linenos="1293 "></span></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><a href="#__codelineno-0-1294"><span class="linenos" data-linenos="1294 "></span></a><span class="sd">        from rich import print</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><a href="#__codelineno-0-1295"><span class="linenos" data-linenos="1295 "></span></a>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><a href="#__codelineno-0-1296"><span class="linenos" data-linenos="1296 "></span></a><span class="sd">        underlying_model = models.vit_b_16()</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><a href="#__codelineno-0-1297"><span class="linenos" data-linenos="1297 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><a href="#__codelineno-0-1298"><span class="linenos" data-linenos="1298 "></span></a><span class="sd">        _ = model(randn(1, 3, 224, 224))</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><a href="#__codelineno-0-1299"><span class="linenos" data-linenos="1299 "></span></a>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><a href="#__codelineno-0-1300"><span class="linenos" data-linenos="1300 "></span></a><span class="sd">        # using statistics name</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><a href="#__codelineno-0-1301"><span class="linenos" data-linenos="1301 "></span></a><span class="sd">        print(model.stat_info(&quot;param&quot;))</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><a href="#__codelineno-0-1302"><span class="linenos" data-linenos="1302 "></span></a>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><a href="#__codelineno-0-1303"><span class="linenos" data-linenos="1303 "></span></a><span class="sd">        # using statistics object</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><a href="#__codelineno-0-1304"><span class="linenos" data-linenos="1304 "></span></a><span class="sd">        cal = model.cal</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><a href="#__codelineno-0-1305"><span class="linenos" data-linenos="1305 "></span></a><span class="sd">        print(model.stat_info(cal))</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><a href="#__codelineno-0-1306"><span class="linenos" data-linenos="1306 "></span></a>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><a href="#__codelineno-0-1307"><span class="linenos" data-linenos="1307 "></span></a><span class="sd">        # not show warnings</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><a href="#__codelineno-0-1308"><span class="linenos" data-linenos="1308 "></span></a><span class="sd">        print(model.stat_info(&quot;mem&quot;, show_warning=False))</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><a href="#__codelineno-0-1309"><span class="linenos" data-linenos="1309 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><a href="#__codelineno-0-1310"><span class="linenos" data-linenos="1310 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><a href="#__codelineno-0-1311"><span class="linenos" data-linenos="1311 "></span></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><a href="#__codelineno-0-1312"><span class="linenos" data-linenos="1312 "></span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stat_or_statname</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><a href="#__codelineno-0-1313"><span class="linenos" data-linenos="1313 "></span></a>        <span class="n">stat</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_or_statname</span><span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><a href="#__codelineno-0-1314"><span class="linenos" data-linenos="1314 "></span></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stat_or_statname</span><span class="p">,</span> <span class="n">Statistics</span><span class="p">):</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><a href="#__codelineno-0-1315"><span class="linenos" data-linenos="1315 "></span></a>        <span class="n">stat</span> <span class="o">=</span> <span class="n">stat_or_statname</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><a href="#__codelineno-0-1316"><span class="linenos" data-linenos="1316 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><a href="#__codelineno-0-1317"><span class="linenos" data-linenos="1317 "></span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><a href="#__codelineno-0-1318"><span class="linenos" data-linenos="1318 "></span></a>            <span class="sa">f</span><span class="s2">&quot;Invalid type for stat_or_statname: `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">stat_or_statname</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`. &quot;</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><a href="#__codelineno-0-1319"><span class="linenos" data-linenos="1319 "></span></a>            <span class="o">+</span> <span class="s2">&quot;Please pass in the statistics name or the statistics object itself.&quot;</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><a href="#__codelineno-0-1320"><span class="linenos" data-linenos="1320 "></span></a>        <span class="p">)</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><a href="#__codelineno-0-1321"><span class="linenos" data-linenos="1321 "></span></a>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><a href="#__codelineno-0-1322"><span class="linenos" data-linenos="1322 "></span></a>    <span class="n">stat_name</span> <span class="o">=</span> <span class="n">stat</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><a href="#__codelineno-0-1323"><span class="linenos" data-linenos="1323 "></span></a>    <span class="n">infos_ls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;â€¢ [b]Statistics:[/b] </span><span class="si">{</span><span class="n">stat_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><a href="#__codelineno-0-1324"><span class="linenos" data-linenos="1324 "></span></a>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><a href="#__codelineno-0-1325"><span class="linenos" data-linenos="1325 "></span></a>    <span class="k">if</span> <span class="n">stat_name</span> <span class="o">==</span> <span class="s2">&quot;ittp&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><a href="#__codelineno-0-1326"><span class="linenos" data-linenos="1326 "></span></a>        <span class="n">infos_ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;â€¢ [b]Benchmark Times:[/b] </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ittp_benchmark_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><a href="#__codelineno-0-1327"><span class="linenos" data-linenos="1327 "></span></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><a href="#__codelineno-0-1328"><span class="linenos" data-linenos="1328 "></span></a>    <span class="n">infos_ls</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;â€¢ [b]</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:[/b] </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">stat</span><span class="o">.</span><span class="n">crucial_data</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><a href="#__codelineno-0-1329"><span class="linenos" data-linenos="1329 "></span></a>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><a href="#__codelineno-0-1330"><span class="linenos" data-linenos="1330 "></span></a>    <span class="c1"># warning field, only works when stat is &quot;cal&quot; or &quot;mem&quot;</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><a href="#__codelineno-0-1331"><span class="linenos" data-linenos="1331 "></span></a>    <span class="k">if</span> <span class="n">show_warning</span> <span class="ow">and</span> <span class="n">stat_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;cal&quot;</span><span class="p">,</span> <span class="s2">&quot;mem&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><a href="#__codelineno-0-1332"><span class="linenos" data-linenos="1332 "></span></a>        <span class="c1"># cache for __has_nocall_nodes</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><a href="#__codelineno-0-1333"><span class="linenos" data-linenos="1333 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__has_nocall_nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><a href="#__codelineno-0-1334"><span class="linenos" data-linenos="1334 "></span></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">attrgetter</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><a href="#__codelineno-0-1335"><span class="linenos" data-linenos="1335 "></span></a>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><a href="#__codelineno-0-1336"><span class="linenos" data-linenos="1336 "></span></a>            <span class="n">crucial_data_getter</span> <span class="o">=</span> <span class="n">attrgetter</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stat_name</span><span class="si">}</span><span class="s2">.crucial_data&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><a href="#__codelineno-0-1337"><span class="linenos" data-linenos="1337 "></span></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><a href="#__codelineno-0-1338"><span class="linenos" data-linenos="1338 "></span></a>                <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">crucial_data_getter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">))</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><a href="#__codelineno-0-1339"><span class="linenos" data-linenos="1339 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__has_nocall_nodes</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><a href="#__codelineno-0-1340"><span class="linenos" data-linenos="1340 "></span></a>            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><a href="#__codelineno-0-1341"><span class="linenos" data-linenos="1341 "></span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__has_nocall_nodes</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><a href="#__codelineno-0-1342"><span class="linenos" data-linenos="1342 "></span></a>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><a href="#__codelineno-0-1343"><span class="linenos" data-linenos="1343 "></span></a>        <span class="c1"># cache for __has_not_support_nodes</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><a href="#__codelineno-0-1344"><span class="linenos" data-linenos="1344 "></span></a>        <span class="k">if</span> <span class="n">stat_name</span> <span class="o">==</span> <span class="s2">&quot;cal&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__has_not_support_nodes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><a href="#__codelineno-0-1345"><span class="linenos" data-linenos="1345 "></span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__has_not_support_nodes</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">cal</span><span class="o">.</span><span class="n">is_not_supported</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">)</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><a href="#__codelineno-0-1346"><span class="linenos" data-linenos="1346 "></span></a>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a><a href="#__codelineno-0-1347"><span class="linenos" data-linenos="1347 "></span></a>        <span class="n">warns_ls</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a><a href="#__codelineno-0-1348"><span class="linenos" data-linenos="1348 "></span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__has_nocall_nodes</span><span class="p">:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a><a href="#__codelineno-0-1349"><span class="linenos" data-linenos="1349 "></span></a>            <span class="n">warns_ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a><a href="#__codelineno-0-1350"><span class="linenos" data-linenos="1350 "></span></a>                <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="s2">&quot;[dim yellow]:arrow_forward:  &quot;</span> <span class="o">+</span> <span class="s2">&quot;Some nodes are defined but not called explicitly.[/]&quot;</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a><a href="#__codelineno-0-1351"><span class="linenos" data-linenos="1351 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a><a href="#__codelineno-0-1352"><span class="linenos" data-linenos="1352 "></span></a>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><a href="#__codelineno-0-1353"><span class="linenos" data-linenos="1353 "></span></a>        <span class="k">if</span> <span class="n">stat_name</span> <span class="o">==</span> <span class="s2">&quot;cal&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__has_not_support_nodes</span><span class="p">:</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><a href="#__codelineno-0-1354"><span class="linenos" data-linenos="1354 "></span></a>            <span class="n">warns_ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a><a href="#__codelineno-0-1355"><span class="linenos" data-linenos="1355 "></span></a>                <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><a href="#__codelineno-0-1356"><span class="linenos" data-linenos="1356 "></span></a>                <span class="o">+</span> <span class="s2">&quot;[dim yellow]:arrow_forward:  &quot;</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><a href="#__codelineno-0-1357"><span class="linenos" data-linenos="1357 "></span></a>                <span class="o">+</span> <span class="s2">&quot;Some modules don&#39;t support calculation measurement yet.[/]&quot;</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><a href="#__codelineno-0-1358"><span class="linenos" data-linenos="1358 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a><a href="#__codelineno-0-1359"><span class="linenos" data-linenos="1359 "></span></a>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><a href="#__codelineno-0-1360"><span class="linenos" data-linenos="1360 "></span></a>        <span class="k">if</span> <span class="n">warns_ls</span><span class="p">:</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><a href="#__codelineno-0-1361"><span class="linenos" data-linenos="1361 "></span></a>            <span class="n">warns_ls</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;[dim yellow]:warning:  Warning: the result may be inaccurate, cause:[/]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><a href="#__codelineno-0-1362"><span class="linenos" data-linenos="1362 "></span></a>            <span class="n">warns_ls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><a href="#__codelineno-0-1363"><span class="linenos" data-linenos="1363 "></span></a>                <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><a href="#__codelineno-0-1364"><span class="linenos" data-linenos="1364 "></span></a>                <span class="o">+</span> <span class="s2">&quot;[dim cyan]:ballot_box_with_check:  &quot;</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><a href="#__codelineno-0-1365"><span class="linenos" data-linenos="1365 "></span></a>                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;use `Meter(your_model).profile(&#39;</span><span class="si">{</span><span class="n">stat_name</span><span class="si">}</span><span class="s2">&#39;)` to see more.[/]&quot;</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><a href="#__codelineno-0-1366"><span class="linenos" data-linenos="1366 "></span></a>            <span class="p">)</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><a href="#__codelineno-0-1367"><span class="linenos" data-linenos="1367 "></span></a>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a><a href="#__codelineno-0-1368"><span class="linenos" data-linenos="1368 "></span></a>        <span class="n">infos_ls</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">warns_ls</span><span class="p">)</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><a href="#__codelineno-0-1369"><span class="linenos" data-linenos="1369 "></span></a>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><a href="#__codelineno-0-1370"><span class="linenos" data-linenos="1370 "></span></a>    <span class="n">infos</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">infos_ls</span><span class="p">)</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><a href="#__codelineno-0-1371"><span class="linenos" data-linenos="1371 "></span></a>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><a href="#__codelineno-0-1372"><span class="linenos" data-linenos="1372 "></span></a>    <span class="n">console</span> <span class="o">=</span> <span class="n">get_console</span><span class="p">()</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><a href="#__codelineno-0-1373"><span class="linenos" data-linenos="1373 "></span></a>    <span class="k">return</span> <span class="n">console</span><span class="o">.</span><span class="n">render_str</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.table_cols" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">table_cols</span>


<a href="#torchmeter.core.Meter.table_cols" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">table_cols</span><span class="p">(</span><span class="n">stat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get all column names of the backend dataframe for the specified statistics.</p>
<p>This method returns the column names of the backend dataframe associated with the given statistics.
If the dataframe is empty(i.e. the <code>profile</code> is not called yet), it falls back to the values of the
<code>tb_fields</code> property of corresponding statistics class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stat_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the statistics for which to retrieve the columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of column names for the specified statistics backend dataframe.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>stat_name</code> is not a string.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>stat_name</code> is not found in the available statistics (i.e. <code>param</code>, <code>cal</code>, <code>mem</code>, <code>ittp</code>).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>default column names for each statistics:
<span class="linenos" data-linenos=" 2 "></span>    - param: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,
<span class="linenos" data-linenos=" 3 "></span>              &quot;Param_Name&quot;, &quot;Requires_Grad&quot;, &quot;Numeric_Num&quot;)
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span>    - cal: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,
<span class="linenos" data-linenos=" 6 "></span>            &quot;Kernel_Size&quot;, &quot;Bias&quot;, &quot;Input&quot;, &quot;Output&quot;, &quot;MACs&quot;, &quot;FLOPs&quot;)
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span>    - mem: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,
<span class="linenos" data-linenos=" 9 "></span>            &quot;Param_Cost&quot;, &quot;Buffer_Cost&quot;, &quot;Output_Cost&quot;, &quot;Total&quot;)
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>    - ittp: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,
<span class="linenos" data-linenos="12 "></span>             &quot;Infer_Time&quot;, &quot;Throughput&quot;)
</code></pre></div>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">table_cols</span><span class="p">(</span><span class="s2">&quot;param&quot;</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># (&#39;Operation_Id&#39;,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c1">#  &#39;Operation_Name&#39;,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a><span class="c1">#  &#39;Operation_Type&#39;,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1">#  &#39;Param_Name&#39;,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="c1">#  &#39;Requires_Grad&#39;,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos="13 "></span></a><span class="c1">#  &#39;Numeric_Num&#39;)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos="15 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">table_cols</span><span class="p">(</span><span class="s2">&quot;cal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos="16 "></span></a><span class="c1"># (&#39;Operation_Id&#39;,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos="17 "></span></a><span class="c1">#  &#39;Operation_Name&#39;,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos="18 "></span></a><span class="c1">#  &#39;Operation_Type&#39;,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos="19 "></span></a><span class="c1">#  &#39;Kernel_Size&#39;,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos="20 "></span></a><span class="c1">#  &#39;Bias&#39;,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos="21 "></span></a><span class="c1">#  &#39;Input&#39;,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos="22 "></span></a><span class="c1">#  &#39;Output&#39;,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos="23 "></span></a><span class="c1">#  &#39;MACs&#39;,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos="24 "></span></a><span class="c1">#  &#39;FLOPs&#39;)</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><a href="#__codelineno-0-1440"><span class="linenos" data-linenos="1440 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">table_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><a href="#__codelineno-0-1441"><span class="linenos" data-linenos="1441 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all column names of the backend dataframe for the specified statistics.</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><a href="#__codelineno-0-1442"><span class="linenos" data-linenos="1442 "></span></a>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a><a href="#__codelineno-0-1443"><span class="linenos" data-linenos="1443 "></span></a><span class="sd">    This method returns the column names of the backend dataframe associated with the given statistics.</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><a href="#__codelineno-0-1444"><span class="linenos" data-linenos="1444 "></span></a><span class="sd">    If the dataframe is empty(i.e. the `profile` is not called yet), it falls back to the values of the</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><a href="#__codelineno-0-1445"><span class="linenos" data-linenos="1445 "></span></a><span class="sd">    `tb_fields` property of corresponding statistics class.</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><a href="#__codelineno-0-1446"><span class="linenos" data-linenos="1446 "></span></a>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><a href="#__codelineno-0-1447"><span class="linenos" data-linenos="1447 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><a href="#__codelineno-0-1448"><span class="linenos" data-linenos="1448 "></span></a><span class="sd">        stat_name (str): The name of the statistics for which to retrieve the columns.</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><a href="#__codelineno-0-1449"><span class="linenos" data-linenos="1449 "></span></a>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><a href="#__codelineno-0-1450"><span class="linenos" data-linenos="1450 "></span></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><a href="#__codelineno-0-1451"><span class="linenos" data-linenos="1451 "></span></a><span class="sd">        A tuple of column names for the specified statistics backend dataframe.</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><a href="#__codelineno-0-1452"><span class="linenos" data-linenos="1452 "></span></a>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><a href="#__codelineno-0-1453"><span class="linenos" data-linenos="1453 "></span></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><a href="#__codelineno-0-1454"><span class="linenos" data-linenos="1454 "></span></a><span class="sd">        TypeError: If `stat_name` is not a string.</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><a href="#__codelineno-0-1455"><span class="linenos" data-linenos="1455 "></span></a><span class="sd">        KeyError: If `stat_name` is not found in the available statistics (i.e. `param`, `cal`, `mem`, `ittp`).</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><a href="#__codelineno-0-1456"><span class="linenos" data-linenos="1456 "></span></a>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><a href="#__codelineno-0-1457"><span class="linenos" data-linenos="1457 "></span></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><a href="#__codelineno-0-1458"><span class="linenos" data-linenos="1458 "></span></a>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><a href="#__codelineno-0-1459"><span class="linenos" data-linenos="1459 "></span></a><span class="sd">        default column names for each statistics:</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><a href="#__codelineno-0-1460"><span class="linenos" data-linenos="1460 "></span></a><span class="sd">            - param: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><a href="#__codelineno-0-1461"><span class="linenos" data-linenos="1461 "></span></a><span class="sd">                      &quot;Param_Name&quot;, &quot;Requires_Grad&quot;, &quot;Numeric_Num&quot;)</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><a href="#__codelineno-0-1462"><span class="linenos" data-linenos="1462 "></span></a>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><a href="#__codelineno-0-1463"><span class="linenos" data-linenos="1463 "></span></a><span class="sd">            - cal: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><a href="#__codelineno-0-1464"><span class="linenos" data-linenos="1464 "></span></a><span class="sd">                    &quot;Kernel_Size&quot;, &quot;Bias&quot;, &quot;Input&quot;, &quot;Output&quot;, &quot;MACs&quot;, &quot;FLOPs&quot;)</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><a href="#__codelineno-0-1465"><span class="linenos" data-linenos="1465 "></span></a>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><a href="#__codelineno-0-1466"><span class="linenos" data-linenos="1466 "></span></a><span class="sd">            - mem: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a><a href="#__codelineno-0-1467"><span class="linenos" data-linenos="1467 "></span></a><span class="sd">                    &quot;Param_Cost&quot;, &quot;Buffer_Cost&quot;, &quot;Output_Cost&quot;, &quot;Total&quot;)</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><a href="#__codelineno-0-1468"><span class="linenos" data-linenos="1468 "></span></a>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><a href="#__codelineno-0-1469"><span class="linenos" data-linenos="1469 "></span></a><span class="sd">            - ittp: (&quot;Operation_Id&quot;, &quot;Operation_Name&quot;, &quot;Operation_Type&quot;,</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><a href="#__codelineno-0-1470"><span class="linenos" data-linenos="1470 "></span></a><span class="sd">                     &quot;Infer_Time&quot;, &quot;Throughput&quot;)</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><a href="#__codelineno-0-1471"><span class="linenos" data-linenos="1471 "></span></a>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><a href="#__codelineno-0-1472"><span class="linenos" data-linenos="1472 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><a href="#__codelineno-0-1473"><span class="linenos" data-linenos="1473 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a><a href="#__codelineno-0-1474"><span class="linenos" data-linenos="1474 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><a href="#__codelineno-0-1475"><span class="linenos" data-linenos="1475 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><a href="#__codelineno-0-1476"><span class="linenos" data-linenos="1476 "></span></a>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><a href="#__codelineno-0-1477"><span class="linenos" data-linenos="1477 "></span></a><span class="sd">        underlying_model = models.resnet18()</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><a href="#__codelineno-0-1478"><span class="linenos" data-linenos="1478 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><a href="#__codelineno-0-1479"><span class="linenos" data-linenos="1479 "></span></a>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><a href="#__codelineno-0-1480"><span class="linenos" data-linenos="1480 "></span></a><span class="sd">        model.table_cols(&quot;param&quot;)</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><a href="#__codelineno-0-1481"><span class="linenos" data-linenos="1481 "></span></a><span class="sd">        # (&#39;Operation_Id&#39;,</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><a href="#__codelineno-0-1482"><span class="linenos" data-linenos="1482 "></span></a><span class="sd">        #  &#39;Operation_Name&#39;,</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><a href="#__codelineno-0-1483"><span class="linenos" data-linenos="1483 "></span></a><span class="sd">        #  &#39;Operation_Type&#39;,</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><a href="#__codelineno-0-1484"><span class="linenos" data-linenos="1484 "></span></a><span class="sd">        #  &#39;Param_Name&#39;,</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><a href="#__codelineno-0-1485"><span class="linenos" data-linenos="1485 "></span></a><span class="sd">        #  &#39;Requires_Grad&#39;,</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><a href="#__codelineno-0-1486"><span class="linenos" data-linenos="1486 "></span></a><span class="sd">        #  &#39;Numeric_Num&#39;)</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><a href="#__codelineno-0-1487"><span class="linenos" data-linenos="1487 "></span></a>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a><a href="#__codelineno-0-1488"><span class="linenos" data-linenos="1488 "></span></a><span class="sd">        model.table_cols(&quot;cal&quot;)</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><a href="#__codelineno-0-1489"><span class="linenos" data-linenos="1489 "></span></a><span class="sd">        # (&#39;Operation_Id&#39;,</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><a href="#__codelineno-0-1490"><span class="linenos" data-linenos="1490 "></span></a><span class="sd">        #  &#39;Operation_Name&#39;,</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><a href="#__codelineno-0-1491"><span class="linenos" data-linenos="1491 "></span></a><span class="sd">        #  &#39;Operation_Type&#39;,</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><a href="#__codelineno-0-1492"><span class="linenos" data-linenos="1492 "></span></a><span class="sd">        #  &#39;Kernel_Size&#39;,</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><a href="#__codelineno-0-1493"><span class="linenos" data-linenos="1493 "></span></a><span class="sd">        #  &#39;Bias&#39;,</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><a href="#__codelineno-0-1494"><span class="linenos" data-linenos="1494 "></span></a><span class="sd">        #  &#39;Input&#39;,</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><a href="#__codelineno-0-1495"><span class="linenos" data-linenos="1495 "></span></a><span class="sd">        #  &#39;Output&#39;,</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><a href="#__codelineno-0-1496"><span class="linenos" data-linenos="1496 "></span></a><span class="sd">        #  &#39;MACs&#39;,</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><a href="#__codelineno-0-1497"><span class="linenos" data-linenos="1497 "></span></a><span class="sd">        #  &#39;FLOPs&#39;)</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><a href="#__codelineno-0-1498"><span class="linenos" data-linenos="1498 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a><a href="#__codelineno-0-1499"><span class="linenos" data-linenos="1499 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><a href="#__codelineno-0-1500"><span class="linenos" data-linenos="1500 "></span></a>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a><a href="#__codelineno-0-1501"><span class="linenos" data-linenos="1501 "></span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stat_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><a href="#__codelineno-0-1502"><span class="linenos" data-linenos="1502 "></span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stat_name must be a string, but got `</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">stat_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><a href="#__codelineno-0-1503"><span class="linenos" data-linenos="1503 "></span></a>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a><a href="#__codelineno-0-1504"><span class="linenos" data-linenos="1504 "></span></a>    <span class="n">stats_data_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table_renderer</span><span class="o">.</span><span class="n">stats_data</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><a href="#__codelineno-0-1505"><span class="linenos" data-linenos="1505 "></span></a>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a><a href="#__codelineno-0-1506"><span class="linenos" data-linenos="1506 "></span></a>    <span class="k">if</span> <span class="n">stat_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stats_data_dict</span><span class="p">:</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a><a href="#__codelineno-0-1507"><span class="linenos" data-linenos="1507 "></span></a>        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Statistics `</span><span class="si">{</span><span class="n">stat_name</span><span class="si">}</span><span class="s2">` not in </span><span class="si">{</span><span class="nb">tuple</span><span class="p">(</span><span class="n">stats_data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a><a href="#__codelineno-0-1508"><span class="linenos" data-linenos="1508 "></span></a>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a><a href="#__codelineno-0-1509"><span class="linenos" data-linenos="1509 "></span></a>    <span class="n">stat_data</span><span class="p">:</span> <span class="n">DataFrame</span> <span class="o">=</span> <span class="n">stats_data_dict</span><span class="p">[</span><span class="n">stat_name</span><span class="p">]</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a><a href="#__codelineno-0-1510"><span class="linenos" data-linenos="1510 "></span></a>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a><a href="#__codelineno-0-1511"><span class="linenos" data-linenos="1511 "></span></a>    <span class="k">if</span> <span class="n">stat_data</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a><a href="#__codelineno-0-1512"><span class="linenos" data-linenos="1512 "></span></a>        <span class="n">cols</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">optree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">stat_name</span><span class="p">)</span><span class="o">.</span><span class="n">tb_fields</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a><a href="#__codelineno-0-1513"><span class="linenos" data-linenos="1513 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a><a href="#__codelineno-0-1514"><span class="linenos" data-linenos="1514 "></span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">stat_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a><a href="#__codelineno-0-1515"><span class="linenos" data-linenos="1515 "></span></a>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a><a href="#__codelineno-0-1516"><span class="linenos" data-linenos="1516 "></span></a>    <span class="k">return</span> <span class="n">cols</span>
</code></pre></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="torchmeter.core.Meter.to" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">to</span>


<a href="#torchmeter.core.Meter.to" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">to</span><span class="p">(</span><span class="n">new_device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">device</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Move the model to the specified device while keeping input and model device synchronization.</p>
<p>Simulate the <code>to</code> method of pytorch model and use it to move model and all tensor data in
<code>self._ipt</code> to the specified device.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>new_device</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="torch.device">device</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target device name or its corresponding torch.device object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchmeter</span><span class="w"> </span><span class="kn">import</span> <span class="n">Meter</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">underlying_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">model</span> <span class="o">=</span> <span class="n">Meter</span><span class="p">(</span><span class="n">underlying_model</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># move to cuda:0</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># move to cpu</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos="12 "></span></a><span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span>
</code></pre></div>
</details>

            <details class="quote">
              <summary>Source code in <code>torchmeter/core.py</code></summary>
              <div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><a href="#__codelineno-0-1180"><span class="linenos" data-linenos="1180 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tc_device</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><a href="#__codelineno-0-1181"><span class="linenos" data-linenos="1181 "></span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Move the model to the specified device while keeping input and model device synchronization.</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><a href="#__codelineno-0-1182"><span class="linenos" data-linenos="1182 "></span></a>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><a href="#__codelineno-0-1183"><span class="linenos" data-linenos="1183 "></span></a><span class="sd">    Simulate the `to` method of pytorch model and use it to move model and all tensor data in</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><a href="#__codelineno-0-1184"><span class="linenos" data-linenos="1184 "></span></a><span class="sd">    `self._ipt` to the specified device.</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><a href="#__codelineno-0-1185"><span class="linenos" data-linenos="1185 "></span></a>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><a href="#__codelineno-0-1186"><span class="linenos" data-linenos="1186 "></span></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><a href="#__codelineno-0-1187"><span class="linenos" data-linenos="1187 "></span></a><span class="sd">        new_device (Union[str, torch.device]): Target device name or its corresponding torch.device object.</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><a href="#__codelineno-0-1188"><span class="linenos" data-linenos="1188 "></span></a>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><a href="#__codelineno-0-1189"><span class="linenos" data-linenos="1189 "></span></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><a href="#__codelineno-0-1190"><span class="linenos" data-linenos="1190 "></span></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><a href="#__codelineno-0-1191"><span class="linenos" data-linenos="1191 "></span></a><span class="sd">        import torch</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><a href="#__codelineno-0-1192"><span class="linenos" data-linenos="1192 "></span></a><span class="sd">        from torchmeter import Meter</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><a href="#__codelineno-0-1193"><span class="linenos" data-linenos="1193 "></span></a><span class="sd">        from torchvision import models</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><a href="#__codelineno-0-1194"><span class="linenos" data-linenos="1194 "></span></a>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><a href="#__codelineno-0-1195"><span class="linenos" data-linenos="1195 "></span></a><span class="sd">        underlying_model = models.resnet18()</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><a href="#__codelineno-0-1196"><span class="linenos" data-linenos="1196 "></span></a><span class="sd">        model = Meter(underlying_model)</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><a href="#__codelineno-0-1197"><span class="linenos" data-linenos="1197 "></span></a>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><a href="#__codelineno-0-1198"><span class="linenos" data-linenos="1198 "></span></a><span class="sd">        # move to cuda:0</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><a href="#__codelineno-0-1199"><span class="linenos" data-linenos="1199 "></span></a><span class="sd">        model.to(&quot;cuda:0&quot;)</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><a href="#__codelineno-0-1200"><span class="linenos" data-linenos="1200 "></span></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><a href="#__codelineno-0-1201"><span class="linenos" data-linenos="1201 "></span></a><span class="sd">        # move to cpu</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><a href="#__codelineno-0-1202"><span class="linenos" data-linenos="1202 "></span></a><span class="sd">        model.to(torch.device(&quot;cpu&quot;))</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><a href="#__codelineno-0-1203"><span class="linenos" data-linenos="1203 "></span></a><span class="sd">        ```</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><a href="#__codelineno-0-1204"><span class="linenos" data-linenos="1204 "></span></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><a href="#__codelineno-0-1205"><span class="linenos" data-linenos="1205 "></span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">new_device</span>  <span class="c1"># type: ignore</span>
</code></pre></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://github.com/TorchMeter" target="_blank">Â© 2025 TorchMeter</a> All rights reserved.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/TorchMeter/torchmeter/discussions" target="_blank" rel="noopener" title="Community" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M208 352c114.9 0 208-78.8 208-176S322.9 0 208 0 0 78.8 0 176c0 38.6 14.7 74.3 39.6 103.4-3.5 9.4-8.7 17.7-14.2 24.7-4.8 6.2-9.7 11-13.3 14.3-1.8 1.6-3.3 2.9-4.3 3.7-.5.4-.9.7-1.1.8l-.2.2C1 327.2-1.4 334.4.8 340.9S9.1 352 16 352c21.8 0 43.8-5.6 62.1-12.5 9.2-3.5 17.8-7.4 25.2-11.4C134.1 343.3 169.8 352 208 352m240-176c0 112.3-99.1 196.9-216.5 207 24.3 74.4 104.9 129 200.5 129 38.2 0 73.9-8.7 104.7-23.9 7.5 4 16 7.9 25.2 11.4 18.3 6.9 40.3 12.5 62.1 12.5 6.9 0 13.1-4.5 15.2-11.1s-.2-13.8-5.8-17.9l-.2-.2c-.2-.2-.6-.4-1.1-.8-1-.8-2.5-2-4.3-3.7-3.6-3.3-8.5-8.1-13.3-14.3-5.5-7-10.7-15.4-14.2-24.7 24.9-29 39.6-64.7 39.6-103.4 0-92.8-84.9-168.9-192.6-175.5.4 5.1.6 10.3.6 15.5z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/TorchMeter/torchmeter" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://pypi.org/project/torchmeter/" target="_blank" rel="noopener" title="PyPI" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/TorchMeter/torchmeter/blob/master/LICENSE" target="_blank" rel="noopener" title="License" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M384 32h128c17.7 0 32 14.3 32 32s-14.3 32-32 32H398.4c-5.2 25.8-22.9 47.1-46.4 57.3V448h160c17.7 0 32 14.3 32 32s-14.3 32-32 32H128c-17.7 0-32-14.3-32-32s14.3-32 32-32h160V153.3c-23.5-10.3-41.2-31.6-46.4-57.3H128c-17.7 0-32-14.3-32-32s14.3-32 32-32h128c14.6-19.4 37.8-32 64-32s49.4 12.6 64 32m55.6 288h144.9L512 195.8zm72.4 96c-62.9 0-115.2-34-126-78.9-2.6-11 1-22.3 6.7-32.1l95.2-163.2c5-8.6 14.2-13.8 24.1-13.8s19.1 5.3 24.1 13.8L631.3 305c5.7 9.8 9.3 21.1 6.7 32.1C627.2 382 574.9 416 512 416M126.8 195.8 54.4 320h144.9zM.9 337.1c-2.6-11 1-22.3 6.7-32.1l95.2-163.2c5-8.6 14.2-13.8 24.1-13.8s19.1 5.3 24.1 13.8L246.2 305c5.7 9.8 9.3 21.1 6.7 32.1C242 382 189.7 416 126.8 416S11.7 382 .9 337.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.view", "content.code.annotate", "content.code.copy", "content.code.annotate", "content.tooltips", "content.tabs.link", "search.share", "search.suggest", "search.highlight", "toc.follow", "navigation.top", "navigation.tabs", "navigation.path", "navigation.tabs.sticky", "navigation.prune", "navigation.tracking", "navigation.instant", "navigation.instant.preview", "navigation.instant.progress", "navigation.indexes", "navigation.sections"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>